# 4.2 Alert / Banner Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a reusable alert/banner component for web and mobile that surfaces inline status messages with icons, optional titles, actions, and dismiss affordances, aligned with Klard design tokens.

**Architecture:** Web: compose on the existing shadcn `Alert` primitive with CVA-driven variants for status colors, optional action/dismiss slots, and `data-slot` tagging for theming. Mobile: pure React Native/Expo component using `StyleSheet` with Klard color tokens and Ionicons, supporting action slot, dismiss button with haptic feedback. Both expose a focused props API for type, title, content, action, size variants, custom icon override, and dismissal, with accessibility baked in (roles, labels, hitSlop).

**Tech Stack:** Next.js 16 (React 19), Tailwind/shadcn `Alert`, class-variance-authority, lucide-react; Expo 54 + React Native (View/Text/Pressable), @expo/vector-icons/Ionicons, expo-haptics; Vitest + @testing-library/react + jsdom (web), Jest + @testing-library/react-native (mobile); TypeScript strict.

---

## Component Summary
- **Component:** `AlertBanner`
- **Purpose:** Prominent inline status messaging with icon, title/description, optional action slot, and optional dismissal.
- **Target Platforms:** Web (`klard-web`) and Mobile (`klard-mobile`) parity (web first).
- **Props (shared intent, platform-specific types):**
  - `type: 'success' | 'error' | 'warning' | 'info'` (required)
  - `title?: React.ReactNode`
  - `children: React.ReactNode` (description/body)
  - `action?: React.ReactNode` (cta/button/links)
  - `dismissible?: boolean` (default false)
  - `onDismiss?: () => void` (required when dismissible true)
  - `size?: 'default' | 'compact'` (optional, default 'default')
  - `icon?: React.ReactNode` (optional override; default status icon)
  - `className?: string` (web), `style?: StyleProp<ViewStyle>` (mobile)
  - `testID?: string` (mobile testing)
- **Visual States:** default/info, success, warning, error; hover/focus ring on action/dismiss controls (web), pressed state for dismiss (mobile); dismissible shows X button; with action renders action element below description; compact size for tighter layouts; supports custom icon override.
- **Size Variants:**
  - `default`: px-4 py-3 (web) / padding 12x10 (mobile)
  - `compact`: px-3 py-2 (web) / padding 10x8 (mobile) for tighter lists
- **Color Tokens:**

### Web Color Tokens
Uses Klard CSS vars with translucent backgrounds and borders:
- Success: `--rec-color-success` with `/10` opacity background and `/35` opacity border
- Error: `--rec-color-error` with `/10` opacity background and `/35` opacity border
- Warning: `--rec-color-warning` with `/10` opacity background and `/35` opacity border
- Info: `--rec-color-secondary` with `/10` opacity background and `/35` opacity border

### Mobile Color Tokens
Uses `Colors.light/dark` with tinted backgrounds:

#### Light Theme
| Type | Background | Border | Text/Icon |
|------|------------|--------|-----------|
| Success | `#F0FDF4` | `#22C55E` | `#166534` |
| Error | `#FEF2F2` | `#EF4444` | `#991B1B` |
| Warning | `#FFFBEB` | `#F59E0B` | `#92400E` |
| Info | `#F0FDFA` | `#14B8A6` | `#134E4A` |

#### Dark Theme
| Type | Background | Border | Text/Icon |
|------|------------|--------|-----------|
| Success | `rgba(34, 197, 94, 0.15)` | `#22C55E` | `#4ADE80` |
| Error | `rgba(239, 68, 68, 0.15)` | `#EF4444` | `#F87171` |
| Warning | `rgba(245, 158, 11, 0.15)` | `#F59E0B` | `#FBBF24` |
| Info | `rgba(20, 184, 166, 0.15)` | `#14B8A6` | `#2DD4BF` |

- **Accessibility:** `role="alert"` and `aria-live="polite"` on web root; dismiss button `aria-label="Dismiss alert"` and keyboard focus styles; mobile uses `accessibilityRole="alert"` on container, `Pressable` with `accessibilityLabel`, `hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}`, and logical order for screen readers.
- **Dependencies:** Web uses `Alert`, `AlertTitle`, `AlertDescription`, `cn`, `cva`, `lucide-react` icons; Mobile uses `View`, `Text`, `Pressable`, `StyleSheet`, `Ionicons` from `@expo/vector-icons`, `expo-haptics`, and `Colors` tokens.
- **SOLID Compliance**

| Component | SRP | OCP | LSP | ISP | DIP |
|-----------|-----|-----|-----|-----|-----|
| AlertBanner (web) | Renders a status banner with icon/action/dismiss | Variants via CVA config; new statuses extend maps | Props allow substituting icon/action without breaking | Minimal props interface; no unused requirements | Depends on abstractions (`ReactNode`, props) and injected icon/action |
| AlertBanner (mobile) | Renders native status banner with action/dismiss | Variant style maps; extendable by adding map entries | Accepts same props contract; style overrides harmless | Segregated props; no forced unused handlers | Uses Colors/Ionicons injected via props rather than hardcoded services |

- **Parallel Sub-Agent Strategy:** Use subagent-driven-development per task: one subagent to author web tests, one for mobile tests in parallel (non-conflicting files); after each implementation step, run quick code-review/checkpoint. If subagents unavailable, emulate the same serially with explicit checkpoints.

- **Test Strategy (TDD):**

### Web Tests (`alert-banner.test.tsx`)
1. Renders with children text
2. Has data-slot attribute
3. Renders all type variants (success, error, warning, info)
4. Shows correct icon for each type
5. Applies correct variant classes for each type (green/red/amber/teal)
6. Renders title when provided
7. Shows dismiss button when dismissible=true
8. Hides dismiss button by default
9. Calls onDismiss when dismiss clicked
10. Renders action element when provided
11. Applies custom className
12. Has role="alert" for accessibility
13. Supports custom icon override
14. Applies size variants (default, compact) correctly

### Mobile Tests (`AlertBanner.test.tsx`)
1. Renders with children text
2. Has correct accessibility role
3. Renders all type variants
4. Shows correct icon for each type
5. Renders title when provided
6. Shows dismiss button when dismissible=true
7. Hides dismiss button by default
8. Calls onDismiss when dismiss pressed
9. Triggers haptic feedback on dismiss
10. Renders action element when provided
11. Supports custom icon override
12. Applies size variants correctly

---

### Task 1: Web - Write failing tests for AlertBanner

**Files:**
- Create: `klard-web/src/__tests__/components/ui/alert-banner.test.tsx`

**Step 1: Write the failing test**
```tsx
/**
 * Tests for AlertBanner Component
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import { describe, it, expect, vi } from "vitest";
import { render, screen, fireEvent } from "@testing-library/react";
import { AlertBanner } from "@/components/ui/alert-banner";

describe("AlertBanner", () => {
  describe("Rendering", () => {
    it("should render with children text", () => {
      render(<AlertBanner type="info">Test message</AlertBanner>);

      expect(screen.getByText("Test message")).toBeInTheDocument();
    });

    it("should have data-slot attribute", () => {
      render(<AlertBanner type="info">Message</AlertBanner>);

      expect(
        document.querySelector('[data-slot="alert-banner"]')
      ).toBeInTheDocument();
    });

    it("should have role=alert for accessibility", () => {
      render(<AlertBanner type="info">Message</AlertBanner>);

      expect(screen.getByRole("alert")).toBeInTheDocument();
    });

    it("should render title when provided", () => {
      render(
        <AlertBanner type="info" title="Alert Title">
          Message
        </AlertBanner>
      );

      expect(screen.getByText("Alert Title")).toBeInTheDocument();
    });
  });

  describe("Type Variants", () => {
    const types = ["success", "error", "warning", "info"] as const;

    types.forEach((type) => {
      it(`should render ${type} variant without error`, () => {
        render(<AlertBanner type={type}>{type} message</AlertBanner>);

        expect(screen.getByText(`${type} message`)).toBeInTheDocument();
      });
    });

    it("should apply success variant with green colors", () => {
      render(<AlertBanner type="success">Success</AlertBanner>);

      const alert = screen.getByRole("alert");
      expect(alert.className).toMatch(/success/);
    });

    it("should apply error variant with red colors", () => {
      render(<AlertBanner type="error">Error</AlertBanner>);

      const alert = screen.getByRole("alert");
      expect(alert.className).toMatch(/error/);
    });

    it("should apply warning variant with amber colors", () => {
      render(<AlertBanner type="warning">Warning</AlertBanner>);

      const alert = screen.getByRole("alert");
      expect(alert.className).toMatch(/warning/);
    });

    it("should apply info variant with teal colors", () => {
      render(<AlertBanner type="info">Info</AlertBanner>);

      const alert = screen.getByRole("alert");
      expect(alert.className).toMatch(/info/);
    });
  });

  describe("Icons", () => {
    it("should render checkmark icon for success type", () => {
      render(<AlertBanner type="success">Success</AlertBanner>);

      expect(document.querySelector("svg")).toBeInTheDocument();
    });

    it("should render alert icon for error type", () => {
      render(<AlertBanner type="error">Error</AlertBanner>);

      expect(document.querySelector("svg")).toBeInTheDocument();
    });
  });

  describe("Size Variants", () => {
    it("should apply default size by default", () => {
      render(<AlertBanner type="info">Message</AlertBanner>);

      const alert = screen.getByRole("alert");
      expect(alert.className).toContain("alert-default");
    });

    it("should apply compact size when specified", () => {
      render(
        <AlertBanner type="info" size="compact">
          Message
        </AlertBanner>
      );

      const alert = screen.getByRole("alert");
      expect(alert.className).toContain("alert-compact");
    });
  });

  describe("Dismissible", () => {
    it("should show dismiss button when dismissible is true", () => {
      render(
        <AlertBanner type="info" dismissible>
          Message
        </AlertBanner>
      );

      expect(
        screen.getByRole("button", { name: /dismiss/i })
      ).toBeInTheDocument();
    });

    it("should not show dismiss button by default", () => {
      render(<AlertBanner type="info">Message</AlertBanner>);

      expect(screen.queryByRole("button")).not.toBeInTheDocument();
    });

    it("should call onDismiss when dismiss button is clicked", () => {
      const handleDismiss = vi.fn();
      render(
        <AlertBanner type="info" dismissible onDismiss={handleDismiss}>
          Message
        </AlertBanner>
      );

      fireEvent.click(screen.getByRole("button", { name: /dismiss/i }));

      expect(handleDismiss).toHaveBeenCalledTimes(1);
    });
  });

  describe("Action", () => {
    it("should render action element when provided", () => {
      render(
        <AlertBanner
          type="info"
          action={<button type="button">Take Action</button>}
        >
          Message
        </AlertBanner>
      );

      expect(
        screen.getByRole("button", { name: "Take Action" })
      ).toBeInTheDocument();
    });
  });

  describe("Custom Icon", () => {
    it("should support custom icon override", () => {
      const customIcon = <span data-testid="custom-icon">!</span>;
      render(
        <AlertBanner type="info" icon={customIcon}>
          Info content
        </AlertBanner>
      );

      expect(screen.getByTestId("custom-icon")).toBeInTheDocument();
    });
  });

  describe("Custom className", () => {
    it("should merge custom className with default classes", () => {
      render(
        <AlertBanner type="info" className="custom-class">
          Message
        </AlertBanner>
      );

      const alert = screen.getByRole("alert");
      expect(alert.className).toContain("custom-class");
    });
  });
});
```

**Step 2: Run test to verify it fails**
Run: `pnpm --filter klard-web test src/__tests__/components/ui/alert-banner.test.tsx --run`
Expected: FAIL (component not found, class expectations unmet).

**Step 3: Write minimal implementation**
See Task 2.

**Step 4: Run test to verify it passes**
Run: `pnpm --filter klard-web test src/__tests__/components/ui/alert-banner.test.tsx --run`
Expected: PASS.

**Step 5: Commit**
`git add klard-web/src/__tests__/components/ui/alert-banner.test.tsx`
`git commit -m "test(web): add alert banner coverage"`

---

### Task 2: Web - Implement AlertBanner component

**Files:**
- Create: `klard-web/src/components/ui/alert-banner.tsx`
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Write the component implementation**
```tsx
'use client';

import { AlertCircle, CheckCircle2, AlertTriangle, Info, X } from 'lucide-react';
import { cva, type VariantProps } from 'class-variance-authority';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { cn } from '@/lib/utils';

const alertBannerVariants = cva(
  'alert-base grid grid-cols-[auto_1fr_auto] gap-2 rounded-[var(--radius-default)] border px-4 py-3 data-[slot=alert-banner]',
  {
    variants: {
      type: {
        success: 'alert-success border-[color:var(--rec-color-success)]/35 bg-[color:var(--rec-color-success)]/10 text-[color:var(--rec-color-success)]',
        error: 'alert-error border-[color:var(--rec-color-error)]/35 bg-[color:var(--rec-color-error)]/10 text-[color:var(--rec-color-error)]',
        warning: 'alert-warning border-[color:var(--rec-color-warning)]/35 bg-[color:var(--rec-color-warning)]/10 text-[color:var(--rec-color-warning)]',
        info: 'alert-info border-[color:var(--rec-color-secondary)]/35 bg-[color:var(--rec-color-secondary)]/10 text-[color:var(--rec-color-secondary)]',
      },
      size: {
        default: 'alert-default',
        compact: 'alert-compact px-3 py-2 text-sm',
      },
    },
    defaultVariants: {
      type: 'info',
      size: 'default',
    },
  }
);

const icons = {
  success: CheckCircle2,
  error: AlertCircle,
  warning: AlertTriangle,
  info: Info,
} as const;

export interface AlertBannerProps
  extends React.ComponentPropsWithoutRef<'div'>,
    VariantProps<typeof alertBannerVariants> {
  title?: React.ReactNode;
  children: React.ReactNode;
  action?: React.ReactNode;
  dismissible?: boolean;
  onDismiss?: () => void;
  icon?: React.ReactNode;
}

export function AlertBanner({
  type = 'info',
  size = 'default',
  title,
  children,
  action,
  dismissible = false,
  onDismiss,
  icon,
  className,
  ...props
}: AlertBannerProps) {
  const Icon = icons[type];
  const handleDismiss = () => {
    onDismiss?.();
  };

  return (
    <Alert
      data-slot="alert-banner"
      role="alert"
      aria-live="polite"
      className={cn(alertBannerVariants({ type, size }), className)}
      {...props}
    >
      <div className="mt-0.5">
        {icon ?? <Icon data-testid="alert-icon" className="h-4 w-4" aria-hidden />}
      </div>
      <div className="space-y-1">
        {title ? <AlertTitle>{title}</AlertTitle> : null}
        <AlertDescription className="text-sm text-[color:inherit]">{children}</AlertDescription>
        {action ? <div className="mt-1">{action}</div> : null}
      </div>
      {dismissible ? (
        <button
          type="button"
          onClick={handleDismiss}
          aria-label="Dismiss alert"
          className="ml-2 inline-flex h-6 w-6 items-center justify-center rounded-full hover:bg-black/5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[color:var(--rec-color-secondary)]"
        >
          <X className="h-4 w-4" />
        </button>
      ) : null}
    </Alert>
  );
}
```

**Step 2: Export component**
```ts
// klard-web/src/components/ui/index.ts
export { AlertBanner, type AlertBannerProps } from './alert-banner';
```

**Step 3: Run tests**
`pnpm --filter klard-web test src/__tests__/components/ui/alert-banner.test.tsx --run`

**Step 4: Commit**
`git add klard-web/src/components/ui/alert-banner.tsx klard-web/src/components/ui/index.ts`
`git commit -m "feat(web): add alert banner component"`

---

### Task 3: Mobile - Write failing tests for AlertBanner

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/AlertBanner.test.tsx`

**Step 1: Write the failing test**
```tsx
/**
 * Tests for AlertBanner Component (Mobile)
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react-native';
import { Text } from 'react-native';
import { AlertBanner } from '@/components/ui/AlertBanner';
import * as Haptics from 'expo-haptics';

// Mock expo-haptics
jest.mock('expo-haptics', () => ({
  impactAsync: jest.fn(),
  ImpactFeedbackStyle: {
    Light: 'light',
    Medium: 'medium',
    Heavy: 'heavy',
  },
}));

// Mock vector icons
jest.mock('@expo/vector-icons', () => {
  const React = require('react');
  const { Text } = require('react-native');
  return {
    Ionicons: ({ name }: { name: string }) => (
      <Text testID="vector-icon">{name}</Text>
    ),
  };
});

describe('AlertBanner', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  describe('Rendering', () => {
    it('should render with children text', () => {
      render(<AlertBanner type="info">Test message</AlertBanner>);

      expect(screen.getByText('Test message')).toBeTruthy();
    });

    it('should have correct accessibility role', () => {
      render(
        <AlertBanner type="info" testID="alert">
          Message
        </AlertBanner>
      );

      const alert = screen.getByTestId('alert');
      expect(alert.props.accessibilityRole).toBe('alert');
    });

    it('should render title when provided', () => {
      render(
        <AlertBanner type="info" title="Alert Title">
          Message
        </AlertBanner>
      );

      expect(screen.getByText('Alert Title')).toBeTruthy();
    });
  });

  describe('Type Variants', () => {
    const types = ['success', 'error', 'warning', 'info'] as const;

    types.forEach((type) => {
      it(`should render ${type} variant without error`, () => {
        render(<AlertBanner type={type}>{type} message</AlertBanner>);

        expect(screen.getByText(`${type} message`)).toBeTruthy();
      });
    });
  });

  describe('Icons', () => {
    it('should render icon for each type', () => {
      render(<AlertBanner type="success">Success</AlertBanner>);

      expect(screen.getByTestId('vector-icon')).toBeTruthy();
    });
  });

  describe('Size Variants', () => {
    it('should apply default size padding', () => {
      const { getByTestId } = render(
        <AlertBanner type="info" testID="banner">
          Message
        </AlertBanner>
      );

      const banner = getByTestId('banner');
      const style = Array.isArray(banner.props.style)
        ? Object.assign({}, ...banner.props.style)
        : banner.props.style;
      expect(style.paddingHorizontal).toBe(12);
      expect(style.paddingVertical).toBe(10);
    });

    it('should apply compact size padding', () => {
      const { getByTestId } = render(
        <AlertBanner type="info" size="compact" testID="banner">
          Message
        </AlertBanner>
      );

      const banner = getByTestId('banner');
      const style = Array.isArray(banner.props.style)
        ? Object.assign({}, ...banner.props.style)
        : banner.props.style;
      expect(style.paddingHorizontal).toBe(10);
      expect(style.paddingVertical).toBe(8);
    });
  });

  describe('Dismissible', () => {
    it('should show dismiss button when dismissible is true', () => {
      render(
        <AlertBanner type="info" dismissible>
          Message
        </AlertBanner>
      );

      expect(screen.getByLabelText(/dismiss/i)).toBeTruthy();
    });

    it('should not show dismiss button by default', () => {
      render(<AlertBanner type="info">Message</AlertBanner>);

      expect(screen.queryByLabelText(/dismiss/i)).toBeNull();
    });

    it('should call onDismiss when dismiss button is pressed', async () => {
      const handleDismiss = jest.fn();
      render(
        <AlertBanner type="info" dismissible onDismiss={handleDismiss}>
          Message
        </AlertBanner>
      );

      fireEvent.press(screen.getByLabelText(/dismiss/i));

      await waitFor(() => {
        expect(handleDismiss).toHaveBeenCalledTimes(1);
      });
    });

    it('should trigger haptic feedback on dismiss', async () => {
      const handleDismiss = jest.fn();
      render(
        <AlertBanner type="info" dismissible onDismiss={handleDismiss}>
          Message
        </AlertBanner>
      );

      fireEvent.press(screen.getByLabelText(/dismiss/i));

      await waitFor(() => {
        expect(Haptics.impactAsync).toHaveBeenCalledWith(
          Haptics.ImpactFeedbackStyle.Light
        );
      });
    });
  });

  describe('Action', () => {
    it('should render action element when provided', () => {
      render(
        <AlertBanner
          type="info"
          action={<Text testID="action-button">Take Action</Text>}
        >
          Message
        </AlertBanner>
      );

      expect(screen.getByTestId('action-button')).toBeTruthy();
    });
  });

  describe('Custom Icon', () => {
    it('should accept custom icon override', () => {
      const icon = <Text testID="custom-icon">!</Text>;
      render(
        <AlertBanner type="info" icon={icon}>
          Info
        </AlertBanner>
      );

      expect(screen.getByTestId('custom-icon')).toBeTruthy();
      expect(screen.queryByTestId('alert-icon')).toBeNull();
    });
  });
});
```

**Step 2: Run test to verify it fails**
Run: `pnpm --filter klard-mobile test src/__tests__/components/ui/AlertBanner.test.tsx --run`
Expected: FAIL (component missing).

**Step 3: Write minimal implementation**
See Task 4.

**Step 4: Run test to verify it passes**
Run: `pnpm --filter klard-mobile test src/__tests__/components/ui/AlertBanner.test.tsx --run`
Expected: PASS.

**Step 5: Commit**
`git add klard-mobile/src/__tests__/components/ui/AlertBanner.test.tsx`
`git commit -m "test(mobile): add alert banner coverage"`

---

### Task 4: Mobile - Implement AlertBanner component

**Files:**
- Create: `klard-mobile/src/components/ui/AlertBanner.tsx`
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Write the component implementation**
```tsx
import React from 'react';
import {
  View,
  Text,
  Pressable,
  StyleSheet,
  useColorScheme,
  type ViewStyle,
  type StyleProp,
} from 'react-native';
import { Ionicons } from '@expo/vector-icons';
import * as Haptics from 'expo-haptics';
import { Colors } from '@/constants';

type AlertType = 'success' | 'error' | 'warning' | 'info';
type AlertSize = 'default' | 'compact';

export interface AlertBannerProps {
  type: AlertType;
  size?: AlertSize;
  title?: React.ReactNode;
  children: React.ReactNode;
  action?: React.ReactNode;
  dismissible?: boolean;
  onDismiss?: () => void;
  icon?: React.ReactNode;
  style?: StyleProp<ViewStyle>;
  testID?: string;
}

const typeIconMap: Record<AlertType, keyof typeof Ionicons.glyphMap> = {
  success: 'checkmark-circle',
  error: 'alert-circle',
  warning: 'warning',
  info: 'information-circle',
};

export function AlertBanner({
  type,
  size = 'default',
  title,
  children,
  action,
  dismissible = false,
  onDismiss,
  icon,
  style,
  testID,
}: AlertBannerProps) {
  const colorScheme = useColorScheme() ?? 'light';
  const palette = Colors[colorScheme];
  const typeColors = getTypeColors(type, colorScheme);
  const padding = sizeStyles[size];

  const handleDismiss = async () => {
    await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
    onDismiss?.();
  };

  return (
    <View
      style={[styles.container, typeColors.container, padding, style]}
      accessibilityRole="alert"
      testID={testID}
    >
      <View style={styles.iconWrapper}>
        {icon ?? (
          <Ionicons
            testID="alert-icon"
            name={typeIconMap[type]}
            size={20}
            color={typeColors.iconColor}
          />
        )}
      </View>
      <View style={styles.content}>
        {title ? <Text style={[styles.title, { color: typeColors.textColor }]}>{title}</Text> : null}
        <Text style={[styles.description, { color: typeColors.textColor }]}>{children}</Text>
        {action ? <View style={styles.actionWrapper}>{action}</View> : null}
      </View>
      {dismissible ? (
        <Pressable
          accessibilityLabel="Dismiss alert"
          accessibilityRole="button"
          hitSlop={{ top: 8, bottom: 8, left: 8, right: 8 }}
          onPress={handleDismiss}
          style={styles.dismiss}
        >
          <Ionicons name="close" size={18} color={typeColors.iconColor} />
        </Pressable>
      ) : null}
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    borderRadius: 12,
    gap: 8,
  },
  iconWrapper: {
    paddingTop: 2,
  },
  content: {
    flex: 1,
    gap: 2,
  },
  title: {
    fontSize: 14,
    fontWeight: '600',
  },
  description: {
    fontSize: 14,
    lineHeight: 20,
  },
  actionWrapper: {
    marginTop: 8,
  },
  dismiss: {
    padding: 4,
    borderRadius: 9999,
    alignSelf: 'flex-start',
  },
});

const sizeStyles = StyleSheet.create({
  default: {
    paddingHorizontal: 12,
    paddingVertical: 10,
  },
  compact: {
    paddingHorizontal: 10,
    paddingVertical: 8,
  },
});

function getTypeColors(
  type: AlertType,
  colorScheme: 'light' | 'dark'
): { container: ViewStyle; textColor: string; iconColor: string } {
  const isLight = colorScheme === 'light';

  const colorMap: Record<
    AlertType,
    { light: typeof lightSuccess; dark: typeof darkSuccess }
  > = {
    success: { light: lightSuccess, dark: darkSuccess },
    error: { light: lightError, dark: darkError },
    warning: { light: lightWarning, dark: darkWarning },
    info: { light: lightInfo, dark: darkInfo },
  };

  return isLight ? colorMap[type].light : colorMap[type].dark;
}

// Light theme colors
const lightSuccess = {
  container: { backgroundColor: '#F0FDF4', borderColor: '#22C55E', borderWidth: 1 },
  textColor: '#166534',
  iconColor: '#22C55E',
};

const lightError = {
  container: { backgroundColor: '#FEF2F2', borderColor: '#EF4444', borderWidth: 1 },
  textColor: '#991B1B',
  iconColor: '#EF4444',
};

const lightWarning = {
  container: { backgroundColor: '#FFFBEB', borderColor: '#F59E0B', borderWidth: 1 },
  textColor: '#92400E',
  iconColor: '#F59E0B',
};

const lightInfo = {
  container: { backgroundColor: '#F0FDFA', borderColor: '#14B8A6', borderWidth: 1 },
  textColor: '#134E4A',
  iconColor: '#14B8A6',
};

// Dark theme colors
const darkSuccess = {
  container: { backgroundColor: 'rgba(34, 197, 94, 0.15)', borderColor: '#22C55E', borderWidth: 1 },
  textColor: '#4ADE80',
  iconColor: '#4ADE80',
};

const darkError = {
  container: { backgroundColor: 'rgba(239, 68, 68, 0.15)', borderColor: '#EF4444', borderWidth: 1 },
  textColor: '#F87171',
  iconColor: '#F87171',
};

const darkWarning = {
  container: { backgroundColor: 'rgba(245, 158, 11, 0.15)', borderColor: '#F59E0B', borderWidth: 1 },
  textColor: '#FBBF24',
  iconColor: '#FBBF24',
};

const darkInfo = {
  container: { backgroundColor: 'rgba(20, 184, 166, 0.15)', borderColor: '#14B8A6', borderWidth: 1 },
  textColor: '#2DD4BF',
  iconColor: '#2DD4BF',
};
```

**Step 2: Export component**
```ts
// klard-mobile/src/components/ui/index.ts
export { AlertBanner, type AlertBannerProps } from './AlertBanner';
```

**Step 3: Run tests**
`pnpm --filter klard-mobile test src/__tests__/components/ui/AlertBanner.test.tsx --run`

**Step 4: Commit**
`git add klard-mobile/src/components/ui/AlertBanner.tsx klard-mobile/src/components/ui/index.ts`
`git commit -m "feat(mobile): add alert banner component"`

---

### Task 5: Verification and spec update

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md` (mark DONE)

**Step 1: Verify**
- `pnpm --filter klard-web test src/__tests__/components/ui/alert-banner.test.tsx --run`
- `pnpm --filter klard-mobile test src/__tests__/components/ui/AlertBanner.test.tsx --run`
- `pnpm --filter klard-web exec tsc --noEmit`
- `pnpm --filter klard-mobile exec tsc --noEmit`

**Step 2: Update spec marker to DONE**
Replace `<!-- IN-PROGRESS:4.2-alert-banner -->` with `<!-- DONE:4.2-alert-banner -->`.

**Step 3: Commit**
`git add docs/screens/batch/Klard_Component_Specifications.md`
`git commit -m "chore: mark 4.2 alert banner done"`

---

## Verification Checklist

Before marking complete, verify:

- [ ] Component renders without errors (web)
- [ ] Component renders without errors (mobile)
- [ ] All props implemented + typed
- [ ] All type variants functional (success, error, warning, info)
- [ ] All size variants functional (default, compact)
- [ ] Custom icon override works
- [ ] Matches design specification visually
- [ ] Accessibility attributes included (role="alert", aria-live, aria-label)
- [ ] Mobile haptic feedback triggers on dismiss
- [ ] TypeScript passes: `pnpm --filter klard-web exec tsc --noEmit`
- [ ] TypeScript passes: `pnpm --filter klard-mobile exec tsc --noEmit`
- [ ] All web tests passing
- [ ] All mobile tests passing
- [ ] Exported from components/ui/index.ts (both)
- [ ] Spec marker updated to DONE