# 5.3 BurnerCardVisual Component Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a production-ready BurnerCardVisual component for both Web (Next.js + Tailwind CSS gradients) and Mobile (React Native + expo-linear-gradient) platforms with full TDD coverage.

**Architecture:** Web uses Tailwind CSS gradient classes for status-based backgrounds. Mobile uses expo-linear-gradient for native gradient rendering. Both display masked card numbers, expiry dates, card type badges, and spending progress bars. Component supports multiple sizes and all card statuses.

**Tech Stack:**
- Web: Next.js 16, React 19, TypeScript strict, Tailwind CSS 4 (gradient classes)
- Mobile: Expo SDK 54, TypeScript strict, expo-linear-gradient

---

## Pre-Implementation Checklist

Before starting, verify these skills are loaded:
- [ ] `superpowers:test-driven-development` - TDD workflow
- [ ] `superpowers:testing-anti-patterns` - Avoid common test mistakes
- [ ] `solid-design-principles` - SOLID compliance

---

## Component Specification

### Props Interface

```typescript
// Shared types
type CardStatus = 'active' | 'locked' | 'expired' | 'used';
type CardType = 'single-use' | 'recurring';
type CardSize = 'sm' | 'md' | 'lg';

interface BurnerCardData {
  nickname: string;
  type: CardType;
  status: CardStatus;
  lastFour: string;
  expiryMonth: string;
  expiryYear: string;
  spentAmount: number;
  spendLimit: number;
}

// Web
interface BurnerCardVisualProps {
  card: BurnerCardData;
  size?: CardSize;
  className?: string;
}

// Mobile
interface BurnerCardVisualProps {
  card: BurnerCardData;
  size?: CardSize;
  style?: StyleProp<ViewStyle>;
  testID?: string;
}
```

### Visual Elements

- **Gradient Background**: Status-based diagonal gradient
- **Brand Name**: "Klard" in top-left
- **Type Badge**: Card type (single-use/recurring) in top-right
- **Card Number**: Masked with last 4 digits visible
- **Nickname**: Card name in footer-left
- **Expiry Date**: MM/YY format below nickname
- **Spending Info**: "Spent" label + amount/limit in footer-right
- **Progress Bar**: Spending progress at bottom

### Status Gradient Colors

| Status | Start Color | End Color | Use Case |
|--------|-------------|-----------|----------|
| active | `#0D7C7A` (teal-700) | `#085E5C` (teal-800) | Card is active and usable |
| locked | `#D97706` (amber-600) | `#B45309` (amber-700) | Card is temporarily locked |
| expired | `#64748B` (slate-500) | `#475569` (slate-600) | Card has expired |
| used | `#475569` (slate-600) | `#334155` (slate-700) | Single-use card already used |

### Size Dimensions

| Size | Web Classes | Mobile (px) | Use Case |
|------|-------------|-------------|----------|
| sm | `w-64 h-40` | 256x160 | List items, compact views |
| md | `w-80 h-48` | 320x192 | Default card display |
| lg | `w-96 h-56` | 384x224 | Featured/detail views |

---

## SOLID Compliance

| Principle | Implementation |
|-----------|----------------|
| **SRP** | BurnerCardVisual only renders card visual - no business logic |
| **OCP** | Extended via className/style props, status via config map |
| **LSP** | All status/size combinations produce valid cards |
| **ISP** | Minimal interface with only necessary props |
| **DIP** | Component depends on abstractions (theme colors, gradient config) |

---

## Dependencies

### Web
- Tailwind CSS gradient utilities (already available)
- `@/lib/utils` - cn utility (already exists)

### Mobile
- `expo-linear-gradient` - For native gradient backgrounds (already installed)
- `@/hooks/useThemeColors` - Theme colors hook (already exists)

---

# PART 1: WEB IMPLEMENTATION

## Task 1: Write Failing Tests for Web BurnerCardVisual Rendering

**Files:**
- Create: `klard-web/src/__tests__/components/ui/burner-card-visual.test.tsx`

**Step 1: Create test file with rendering tests**

```tsx
/**
 * Tests for BurnerCardVisual Component (Web)
 *
 * TDD: Write failing tests first, then implement to pass.
 * Tests verify: rendering, sizes, status variants, accessibility
 */

import { describe, it, expect } from 'vitest';
import { render, screen } from '@testing-library/react';
import { BurnerCardVisual } from '@/components/ui/burner-card-visual';

const mockActiveCard = {
  nickname: 'Netflix Subscription',
  type: 'recurring' as const,
  status: 'active' as const,
  lastFour: '4242',
  expiryMonth: '12',
  expiryYear: '25',
  spentAmount: 15.99,
  spendLimit: 20.00,
};

describe('BurnerCardVisual', () => {
  describe('Rendering', () => {
    it('should render card container with data-slot', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card).toBeInTheDocument();
    });

    it('should display Klard brand name', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Klard')).toBeInTheDocument();
    });

    it('should display card type badge', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('recurring')).toBeInTheDocument();
    });

    it('should display masked card number with last four digits', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText(/•••• •••• •••• 4242/)).toBeInTheDocument();
    });

    it('should display card nickname', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Netflix Subscription')).toBeInTheDocument();
    });

    it('should display expiry date', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('12/25')).toBeInTheDocument();
    });

    it('should display spending information', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Spent')).toBeInTheDocument();
      expect(screen.getByText('$15.99 / $20.00')).toBeInTheDocument();
    });

    it('should render progress bar track', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const progressTrack = container.querySelector('[data-slot="spending-progress-track"]');
      expect(progressTrack).toBeInTheDocument();
    });

    it('should render progress bar fill', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const progressFill = container.querySelector('[data-slot="spending-progress-fill"]');
      expect(progressFill).toBeInTheDocument();
    });
  });
});
```

**Step 2: Run tests to verify they fail**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps
pnpm --filter klard-web test src/__tests__/components/ui/burner-card-visual.test.tsx --run
```

Expected: FAIL - BurnerCardVisual component doesn't exist

---

## Task 2: Write Failing Tests for Web Sizes and Status Variants

**Files:**
- Modify: `klard-web/src/__tests__/components/ui/burner-card-visual.test.tsx`

**Step 1: Add size and status tests**

```tsx
const mockLockedCard = {
  ...mockActiveCard,
  status: 'locked' as const,
};

const mockExpiredCard = {
  ...mockActiveCard,
  status: 'expired' as const,
};

const mockUsedCard = {
  ...mockActiveCard,
  type: 'single-use' as const,
  status: 'used' as const,
};

  describe('Sizes', () => {
    it('should apply sm size class', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} size="sm" />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('w-64');
      expect(card?.className).toContain('h-40');
    });

    it('should apply md size class by default', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('w-80');
      expect(card?.className).toContain('h-48');
    });

    it('should apply lg size class', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} size="lg" />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('w-96');
      expect(card?.className).toContain('h-56');
    });
  });

  describe('Status Variants', () => {
    it('should apply active gradient classes', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('from-teal-700');
      expect(card?.className).toContain('to-teal-800');
    });

    it('should apply locked gradient classes', () => {
      const { container } = render(<BurnerCardVisual card={mockLockedCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('from-amber-600');
      expect(card?.className).toContain('to-amber-700');
    });

    it('should apply expired gradient classes', () => {
      const { container } = render(<BurnerCardVisual card={mockExpiredCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('from-slate-500');
      expect(card?.className).toContain('to-slate-600');
    });

    it('should apply used gradient classes', () => {
      const { container } = render(<BurnerCardVisual card={mockUsedCard} />);

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card?.className).toContain('from-slate-600');
      expect(card?.className).toContain('to-slate-700');
    });
  });
```

**Step 2: Run tests to verify they fail**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/burner-card-visual.test.tsx --run
```

Expected: FAIL - Size/status props not implemented

---

## Task 3: Write Failing Tests for Web Accessibility and Progress Calculation

**Files:**
- Modify: `klard-web/src/__tests__/components/ui/burner-card-visual.test.tsx`

**Step 1: Add accessibility and progress tests**

```tsx
  describe('Accessibility', () => {
    it('should have article role', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByRole('article');
      expect(card).toBeInTheDocument();
    });

    it('should have aria-label with card info', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByRole('article');
      expect(card.getAttribute('aria-label')).toContain('Netflix Subscription');
      expect(card.getAttribute('aria-label')).toContain('4242');
    });
  });

  describe('Progress Calculation', () => {
    it('should set correct progress width style', () => {
      const { container } = render(<BurnerCardVisual card={mockActiveCard} />);

      const progressFill = container.querySelector('[data-slot="spending-progress-fill"]');
      // 15.99 / 20.00 = 79.95%
      expect(progressFill?.getAttribute('style')).toContain('width: 79.95%');
    });

    it('should cap progress at 100%', () => {
      const overSpentCard = {
        ...mockActiveCard,
        spentAmount: 25.00,
        spendLimit: 20.00,
      };
      const { container } = render(<BurnerCardVisual card={overSpentCard} />);

      const progressFill = container.querySelector('[data-slot="spending-progress-fill"]');
      expect(progressFill?.getAttribute('style')).toContain('width: 100%');
    });

    it('should handle zero spend limit', () => {
      const zeroLimitCard = {
        ...mockActiveCard,
        spentAmount: 0,
        spendLimit: 0,
      };
      const { container } = render(<BurnerCardVisual card={zeroLimitCard} />);

      const progressFill = container.querySelector('[data-slot="spending-progress-fill"]');
      expect(progressFill?.getAttribute('style')).toContain('width: 0%');
    });
  });

  describe('Custom className', () => {
    it('should merge custom className', () => {
      const { container } = render(
        <BurnerCardVisual card={mockActiveCard} className="custom-class" />
      );

      const card = container.querySelector('[data-slot="burner-card-visual"]');
      expect(card).toHaveClass('custom-class');
    });
  });
```

**Step 2: Run all tests to verify they fail**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/burner-card-visual.test.tsx --run
```

Expected: Multiple FAIL

---

## Task 4: Implement Web BurnerCardVisual Component

**Files:**
- Create: `klard-web/src/components/ui/burner-card-visual.tsx`

**Step 1: Create the BurnerCardVisual component**

```tsx
import * as React from 'react';
import { cn } from '@/lib/utils';

export type CardStatus = 'active' | 'locked' | 'expired' | 'used';
export type CardType = 'single-use' | 'recurring';
export type CardSize = 'sm' | 'md' | 'lg';

export interface BurnerCardData {
  nickname: string;
  type: CardType;
  status: CardStatus;
  lastFour: string;
  expiryMonth: string;
  expiryYear: string;
  spentAmount: number;
  spendLimit: number;
}

export interface BurnerCardVisualProps {
  card: BurnerCardData;
  size?: CardSize;
  className?: string;
}

const statusGradients: Record<CardStatus, string> = {
  active: 'from-teal-700 to-teal-800',
  locked: 'from-amber-600 to-amber-700',
  expired: 'from-slate-500 to-slate-600',
  used: 'from-slate-600 to-slate-700',
};

const sizeClasses: Record<CardSize, string> = {
  sm: 'w-64 h-40',
  md: 'w-80 h-48',
  lg: 'w-96 h-56',
};

function formatCurrency(amount: number): string {
  return `$${amount.toFixed(2)}`;
}

function calculateProgressPercentage(spent: number, limit: number): number {
  if (limit <= 0) return 0;
  return Math.min((spent / limit) * 100, 100);
}

function BurnerCardVisual({
  card,
  size = 'md',
  className,
}: BurnerCardVisualProps) {
  const {
    nickname,
    type,
    status,
    lastFour,
    expiryMonth,
    expiryYear,
    spentAmount,
    spendLimit,
  } = card;

  const progressPercentage = calculateProgressPercentage(spentAmount, spendLimit);

  const accessibilityLabel = `${nickname} card ending in ${lastFour}, ${status}, spent ${formatCurrency(spentAmount)} of ${formatCurrency(spendLimit)}`;

  return (
    <article
      data-slot="burner-card-visual"
      role="article"
      aria-label={accessibilityLabel}
      className={cn(
        'relative flex flex-col justify-between rounded-2xl p-5 bg-gradient-to-br',
        statusGradients[status],
        sizeClasses[size],
        className
      )}
    >
      {/* Header: Brand + Type Badge */}
      <div className="flex items-center justify-between">
        <span className="text-xl font-bold text-white tracking-wide">Klard</span>
        <span className="rounded bg-white/20 px-2 py-1 text-[10px] font-semibold uppercase text-white">
          {type}
        </span>
      </div>

      {/* Card Number */}
      <p className="text-center text-lg font-medium tracking-[3px] text-white">
        •••• •••• •••• {lastFour}
      </p>

      {/* Footer: Card Info + Spending */}
      <div>
        <div className="flex items-end justify-between">
          <div className="flex-1">
            <p className="text-sm font-semibold text-white">{nickname}</p>
            <p className="text-xs text-white/80">
              {expiryMonth}/{expiryYear}
            </p>
          </div>
          <div className="text-right">
            <p className="text-[10px] uppercase text-white/70">Spent</p>
            <p className="text-xs font-semibold text-white">
              {formatCurrency(spentAmount)} / {formatCurrency(spendLimit)}
            </p>
          </div>
        </div>

        {/* Progress Bar */}
        <div className="mt-3">
          <div
            data-slot="spending-progress-track"
            className="h-1 w-full overflow-hidden rounded-full bg-white/30"
          >
            <div
              data-slot="spending-progress-fill"
              className="h-full rounded-full bg-white/90 transition-all duration-300"
              style={{ width: `${progressPercentage.toFixed(2)}%` }}
            />
          </div>
        </div>
      </div>
    </article>
  );
}

export { BurnerCardVisual };
```

**Step 2: Run tests to verify they pass**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/burner-card-visual.test.tsx --run
```

Expected: All tests PASS

---

## Task 5: Export Web BurnerCardVisual from Index

**Files:**
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Add BurnerCardVisual export**

Add this line to the exports:

```typescript
export {
  BurnerCardVisual,
  type BurnerCardVisualProps,
  type BurnerCardData,
  type CardStatus,
  type CardType,
  type CardSize,
} from './burner-card-visual';
```

**Step 2: Verify TypeScript compiles**

```bash
pnpm --filter klard-web exec tsc --noEmit
```

Expected: No TypeScript errors

**Step 3: Commit Web implementation**

```bash
git add klard-web/src/components/ui/burner-card-visual.tsx klard-web/src/components/ui/index.ts klard-web/src/__tests__/components/ui/burner-card-visual.test.tsx
git commit -m "feat(web): add BurnerCardVisual component with TDD

- Add BurnerCardVisual component using Tailwind CSS gradients
- Support 4 status variants: active, locked, expired, used
- Support 3 sizes: sm, md, lg
- Display card details, spending info, and progress bar
- Comprehensive test coverage"
```

---

# PART 2: MOBILE IMPLEMENTATION

## Task 6: Write Failing Tests for Mobile BurnerCardVisual Rendering

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/BurnerCardVisual.test.tsx`

**Step 1: Create test file with rendering tests**

```tsx
/**
 * Tests for BurnerCardVisual Component (Mobile)
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import React from 'react';
import { render, screen } from '@testing-library/react-native';
import { BurnerCardVisual } from '@/components/ui/BurnerCardVisual';

// Mock expo-linear-gradient
jest.mock('expo-linear-gradient', () => ({
  LinearGradient: ({ children, testID, style, ...props }: any) => {
    const { View } = require('react-native');
    return (
      <View testID={testID} style={style} {...props}>
        {children}
      </View>
    );
  },
}));

// Mock hooks
jest.mock('@/hooks', () => ({
  useThemeColors: () => ({
    primary: '#0D7C7A',
    textPrimary: '#FFFFFF',
    textSecondary: '#94A3B8',
    muted: 'rgba(255,255,255,0.3)',
  }),
}));

const mockActiveCard = {
  nickname: 'Netflix Subscription',
  type: 'recurring' as const,
  status: 'active' as const,
  lastFour: '4242',
  expiryMonth: '12',
  expiryYear: '25',
  spentAmount: 15.99,
  spendLimit: 20.00,
};

describe('BurnerCardVisual', () => {
  describe('Rendering', () => {
    it('should render card container', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByTestId('burner-card-visual')).toBeTruthy();
    });

    it('should display Klard brand name', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Klard')).toBeTruthy();
    });

    it('should display card type badge', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('recurring')).toBeTruthy();
    });

    it('should display masked card number with last four digits', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText(/•••• •••• •••• 4242/)).toBeTruthy();
    });

    it('should display card nickname', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Netflix Subscription')).toBeTruthy();
    });

    it('should display expiry date', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('12/25')).toBeTruthy();
    });

    it('should display spending information', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByText('Spent')).toBeTruthy();
      expect(screen.getByText('$15.99 / $20.00')).toBeTruthy();
    });

    it('should render progress bar track', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByTestId('spending-progress-track')).toBeTruthy();
    });

    it('should render progress bar fill', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      expect(screen.getByTestId('spending-progress-fill')).toBeTruthy();
    });
  });
});
```

**Step 2: Run tests to verify they fail**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps
pnpm --filter klard-mobile test src/__tests__/components/ui/BurnerCardVisual.test.tsx --run
```

Expected: FAIL - BurnerCardVisual component doesn't exist

---

## Task 7: Write Failing Tests for Mobile Sizes and Status Variants

**Files:**
- Modify: `klard-mobile/src/__tests__/components/ui/BurnerCardVisual.test.tsx`

**Step 1: Add size and status tests**

```tsx
const mockLockedCard = {
  ...mockActiveCard,
  status: 'locked' as const,
};

const mockExpiredCard = {
  ...mockActiveCard,
  status: 'expired' as const,
};

const mockUsedCard = {
  ...mockActiveCard,
  type: 'single-use' as const,
  status: 'used' as const,
};

  describe('Sizes', () => {
    it('should apply sm size (256x160)', () => {
      render(<BurnerCardVisual card={mockActiveCard} size="sm" />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card.props.style).toMatchObject({ width: 256, height: 160 });
    });

    it('should apply md size by default (320x192)', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card.props.style).toMatchObject({ width: 320, height: 192 });
    });

    it('should apply lg size (384x224)', () => {
      render(<BurnerCardVisual card={mockActiveCard} size="lg" />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card.props.style).toMatchObject({ width: 384, height: 224 });
    });
  });

  describe('Status Variants', () => {
    it('should render active status card', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card).toBeTruthy();
    });

    it('should render locked status card', () => {
      render(<BurnerCardVisual card={mockLockedCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card).toBeTruthy();
    });

    it('should render expired status card', () => {
      render(<BurnerCardVisual card={mockExpiredCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card).toBeTruthy();
    });

    it('should render used status card', () => {
      render(<BurnerCardVisual card={mockUsedCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card).toBeTruthy();
    });
  });
```

**Step 2: Run tests to verify they fail**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/BurnerCardVisual.test.tsx --run
```

Expected: FAIL - Size/status props not implemented

---

## Task 8: Write Failing Tests for Mobile Accessibility and Progress Calculation

**Files:**
- Modify: `klard-mobile/src/__tests__/components/ui/BurnerCardVisual.test.tsx`

**Step 1: Add accessibility and progress tests**

```tsx
  describe('Accessibility', () => {
    it('should have summary accessibility role', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card.props.accessibilityRole).toBe('summary');
    });

    it('should have accessibility label with card info', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const card = screen.getByTestId('burner-card-visual');
      expect(card.props.accessibilityLabel).toContain('Netflix Subscription');
      expect(card.props.accessibilityLabel).toContain('4242');
    });
  });

  describe('Progress Calculation', () => {
    it('should calculate correct progress percentage', () => {
      render(<BurnerCardVisual card={mockActiveCard} />);

      const progressFill = screen.getByTestId('spending-progress-fill');
      // 15.99 / 20.00 = 79.95%
      expect(progressFill.props.style).toMatchObject({ width: '79.95%' });
    });

    it('should cap progress at 100%', () => {
      const overSpentCard = {
        ...mockActiveCard,
        spentAmount: 25.00,
        spendLimit: 20.00,
      };
      render(<BurnerCardVisual card={overSpentCard} />);

      const progressFill = screen.getByTestId('spending-progress-fill');
      expect(progressFill.props.style).toMatchObject({ width: '100%' });
    });

    it('should handle zero spend limit', () => {
      const zeroLimitCard = {
        ...mockActiveCard,
        spentAmount: 0,
        spendLimit: 0,
      };
      render(<BurnerCardVisual card={zeroLimitCard} />);

      const progressFill = screen.getByTestId('spending-progress-fill');
      expect(progressFill.props.style).toMatchObject({ width: '0%' });
    });
  });
```

**Step 2: Run all tests to verify they fail**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/BurnerCardVisual.test.tsx --run
```

Expected: Multiple FAIL

---

## Task 9: Implement Mobile BurnerCardVisual Component

**Files:**
- Create: `klard-mobile/src/components/ui/BurnerCardVisual/BurnerCardVisual.tsx`
- Create: `klard-mobile/src/components/ui/BurnerCardVisual/burner-card-visual.styles.ts`
- Create: `klard-mobile/src/components/ui/BurnerCardVisual/index.ts`

**Step 1: Create styles file**

```typescript
// klard-mobile/src/components/ui/BurnerCardVisual/burner-card-visual.styles.ts
import { StyleSheet } from 'react-native';

export const styles = StyleSheet.create({
  card: {
    borderRadius: 16,
    padding: 20,
    justifyContent: 'space-between',
  },
  header: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
  },
  brand: {
    fontSize: 20,
    fontWeight: '700',
    color: '#FFFFFF',
    letterSpacing: 1,
  },
  typeBadge: {
    backgroundColor: 'rgba(255, 255, 255, 0.2)',
    paddingHorizontal: 8,
    paddingVertical: 4,
    borderRadius: 4,
  },
  typeText: {
    fontSize: 10,
    fontWeight: '600',
    color: '#FFFFFF',
    textTransform: 'uppercase',
  },
  cardNumber: {
    fontSize: 18,
    fontWeight: '500',
    color: '#FFFFFF',
    letterSpacing: 3,
    textAlign: 'center',
  },
  footer: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'flex-end',
  },
  cardInfo: {
    flex: 1,
  },
  nickname: {
    fontSize: 14,
    fontWeight: '600',
    color: '#FFFFFF',
    marginBottom: 2,
  },
  expiry: {
    fontSize: 12,
    color: 'rgba(255, 255, 255, 0.8)',
  },
  spending: {
    alignItems: 'flex-end',
  },
  spendLabel: {
    fontSize: 10,
    color: 'rgba(255, 255, 255, 0.7)',
    textTransform: 'uppercase',
    marginBottom: 2,
  },
  spendAmount: {
    fontSize: 12,
    fontWeight: '600',
    color: '#FFFFFF',
  },
  progressContainer: {
    marginTop: 12,
  },
  progressTrack: {
    height: 4,
    backgroundColor: 'rgba(255, 255, 255, 0.3)',
    borderRadius: 2,
    overflow: 'hidden',
  },
  progressFill: {
    height: '100%',
    backgroundColor: 'rgba(255, 255, 255, 0.9)',
    borderRadius: 2,
  },
});

export const sizeMap = {
  sm: { width: 256, height: 160 },
  md: { width: 320, height: 192 },
  lg: { width: 384, height: 224 },
} as const;
```

**Step 2: Create BurnerCardVisual component**

```tsx
// klard-mobile/src/components/ui/BurnerCardVisual/BurnerCardVisual.tsx
import React from 'react';
import { View, Text, type StyleProp, type ViewStyle } from 'react-native';
import { LinearGradient } from 'expo-linear-gradient';
import { styles, sizeMap } from './burner-card-visual.styles';

export type CardStatus = 'active' | 'locked' | 'expired' | 'used';
export type CardType = 'single-use' | 'recurring';
export type CardSize = 'sm' | 'md' | 'lg';

export interface BurnerCardData {
  nickname: string;
  type: CardType;
  status: CardStatus;
  lastFour: string;
  expiryMonth: string;
  expiryYear: string;
  spentAmount: number;
  spendLimit: number;
}

export interface BurnerCardVisualProps {
  card: BurnerCardData;
  size?: CardSize;
  style?: StyleProp<ViewStyle>;
  testID?: string;
}

const statusGradients: Record<CardStatus, [string, string]> = {
  active: ['#0D7C7A', '#085E5C'],
  locked: ['#D97706', '#B45309'],
  expired: ['#64748B', '#475569'],
  used: ['#475569', '#334155'],
};

function formatCurrency(amount: number): string {
  return `$${amount.toFixed(2)}`;
}

function calculateProgressPercentage(spent: number, limit: number): string {
  if (limit <= 0) return '0%';
  const percentage = Math.min((spent / limit) * 100, 100);
  return `${percentage.toFixed(2)}%`;
}

function BurnerCardVisual({
  card,
  size = 'md',
  style,
  testID,
}: BurnerCardVisualProps) {
  const {
    nickname,
    type,
    status,
    lastFour,
    expiryMonth,
    expiryYear,
    spentAmount,
    spendLimit,
  } = card;

  const dimensions = sizeMap[size];
  const gradientColors = statusGradients[status];
  const progressWidth = calculateProgressPercentage(spentAmount, spendLimit);

  const accessibilityLabel = `${nickname} card ending in ${lastFour}, ${status}, spent ${formatCurrency(spentAmount)} of ${formatCurrency(spendLimit)}`;

  return (
    <LinearGradient
      colors={gradientColors}
      start={{ x: 0, y: 0 }}
      end={{ x: 1, y: 1 }}
      style={[styles.card, dimensions, style]}
      testID={testID ?? 'burner-card-visual'}
      accessibilityRole="summary"
      accessibilityLabel={accessibilityLabel}
    >
      {/* Header: Brand + Type Badge */}
      <View style={styles.header}>
        <Text style={styles.brand}>Klard</Text>
        <View style={styles.typeBadge}>
          <Text style={styles.typeText}>{type}</Text>
        </View>
      </View>

      {/* Card Number */}
      <Text style={styles.cardNumber}>•••• •••• •••• {lastFour}</Text>

      {/* Footer: Card Info + Spending */}
      <View>
        <View style={styles.footer}>
          <View style={styles.cardInfo}>
            <Text style={styles.nickname}>{nickname}</Text>
            <Text style={styles.expiry}>
              {expiryMonth}/{expiryYear}
            </Text>
          </View>
          <View style={styles.spending}>
            <Text style={styles.spendLabel}>Spent</Text>
            <Text style={styles.spendAmount}>
              {formatCurrency(spentAmount)} / {formatCurrency(spendLimit)}
            </Text>
          </View>
        </View>

        {/* Progress Bar */}
        <View style={styles.progressContainer}>
          <View style={styles.progressTrack} testID="spending-progress-track">
            <View
              style={[styles.progressFill, { width: progressWidth }]}
              testID="spending-progress-fill"
            />
          </View>
        </View>
      </View>
    </LinearGradient>
  );
}

export { BurnerCardVisual };
```

**Step 3: Create index file**

```typescript
// klard-mobile/src/components/ui/BurnerCardVisual/index.ts
export {
  BurnerCardVisual,
  type BurnerCardVisualProps,
  type BurnerCardData,
  type CardStatus,
  type CardType,
  type CardSize,
} from './BurnerCardVisual';
```

**Step 4: Run tests to verify they pass**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/BurnerCardVisual.test.tsx --run
```

Expected: All tests PASS

---

## Task 10: Export Mobile BurnerCardVisual from Index

**Files:**
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Add BurnerCardVisual export**

Add this line to the exports:

```typescript
export {
  BurnerCardVisual,
  type BurnerCardVisualProps,
  type BurnerCardData,
  type CardStatus,
  type CardType,
  type CardSize,
} from './BurnerCardVisual';
```

**Step 2: Verify TypeScript compiles**

```bash
pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No TypeScript errors

**Step 3: Commit Mobile implementation**

```bash
git add klard-mobile/src/components/ui/BurnerCardVisual/ klard-mobile/src/components/ui/index.ts klard-mobile/src/__tests__/components/ui/BurnerCardVisual.test.tsx
git commit -m "feat(mobile): add BurnerCardVisual component with TDD

- Add BurnerCardVisual component using expo-linear-gradient
- Support 4 status variants: active, locked, expired, used
- Support 3 sizes: sm, md, lg
- Display card details, spending info, and progress bar
- Comprehensive test coverage"
```

---

# PART 3: VERIFICATION & COMPLETION

## Task 11: Run Full Test Suite

**Step 1: Run all web tests**

```bash
pnpm --filter klard-web test --run
```

Expected: All tests PASS

**Step 2: Run all mobile tests**

```bash
pnpm --filter klard-mobile test --run
```

Expected: All tests PASS

**Step 3: Run TypeScript check on both**

```bash
pnpm --filter klard-web exec tsc --noEmit && pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No TypeScript errors

---

## Task 12: Verification Checklist

Complete this checklist before marking component as DONE:

**Web BurnerCardVisual:**
- [ ] Component renders without errors
- [ ] All 4 status variants work (active, locked, expired, used)
- [ ] All 3 sizes work (sm, md, lg)
- [ ] Card details display correctly (brand, type, number, nickname, expiry)
- [ ] Spending info displays correctly
- [ ] Progress bar calculates correctly
- [ ] Progress caps at 100%
- [ ] Zero limit handled gracefully
- [ ] Accessibility: role=article, aria-label present
- [ ] Custom className merges correctly
- [ ] TypeScript compiles with no errors
- [ ] All tests passing
- [ ] Exported from index.ts

**Mobile BurnerCardVisual:**
- [ ] Component renders without errors
- [ ] LinearGradient displays correctly
- [ ] All 4 status variants work (active, locked, expired, used)
- [ ] All 3 sizes work (sm, md, lg)
- [ ] Card details display correctly
- [ ] Spending info displays correctly
- [ ] Progress bar calculates correctly
- [ ] Accessibility: role=summary, accessibilityLabel present
- [ ] TypeScript compiles with no errors
- [ ] All tests passing
- [ ] Exported from index.ts

---

## Task 13: Mark Component as DONE

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md`

**Step 1: Update spec marker**

Replace:
```
<!-- IN-PROGRESS:5.3-burner-card-visual -->
```

With:
```
<!-- DONE:5.3-burner-card-visual -->
```

**Step 2: Final commit**

```bash
git add docs/screens/batch/Klard_Component_Specifications.md
git commit -m "docs: mark 5.3-burner-card-visual component as DONE"
```

---

## Summary

| Task | Platform | Description |
|------|----------|-------------|
| 1-3 | Web | Write failing tests (TDD RED phase) |
| 4 | Web | Implement BurnerCardVisual component (TDD GREEN phase) |
| 5 | Web | Export from index.ts |
| 6-8 | Mobile | Write failing tests (TDD RED phase) |
| 9 | Mobile | Implement BurnerCardVisual component (TDD GREEN phase) |
| 10 | Mobile | Export from index.ts |
| 11 | Both | Run full test suite |
| 12 | Both | Verification checklist |
| 13 | Docs | Mark component as DONE |

**Total Tasks:** 13
**Estimated Time:** 30-45 minutes

---

## File Structure

### Web
```
klard-web/src/
├── components/ui/
│   ├── burner-card-visual.tsx  # Component
│   └── index.ts                # Export added
└── __tests__/components/ui/
    └── burner-card-visual.test.tsx # Test file
```

### Mobile
```
klard-mobile/src/
├── components/ui/
│   ├── BurnerCardVisual/
│   │   ├── BurnerCardVisual.tsx       # Component
│   │   ├── burner-card-visual.styles.ts # Styles
│   │   └── index.ts                   # Barrel export
│   └── index.ts                       # Export added
└── __tests__/components/ui/
    └── BurnerCardVisual.test.tsx      # Test file
```

---

## Execution Options

**Plan complete and saved to `docs/screens/comp-plan/5.3-burner-card-visual-implementation-plan.md`.**

**Two execution options:**

1. **Subagent-Driven (this session)** - Dispatch fresh subagent per task, review between tasks, fast iteration

2. **Parallel Session (separate)** - Open new session with executing-plans, batch execution with checkpoints

**Which approach?**