# Tabs Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a cross-platform Tabs component for organizing content into labeled tab panels with optional icons and badges, supporting controlled selection via `value/onChange`.

**Architecture:** Web uses shadcn/ui `Tabs` primitives to render a Tabs container with a `TabsList`/`TabsTrigger` map and consumer-supplied `TabsContent`. Style variants handled with Tailwind + minimal CVA for density spacing, with data-slot tagging and badge/icon layout. Mobile uses a horizontal ScrollView-based tab bar with Pressable tabs, optional badges/icons, safe area-aware padding, and controlled selection.

**Tech Stack:** Next.js 16 App Router, React 19, Tailwind 4, shadcn/ui Tabs + Badge, class-variance-authority, Vitest + Testing Library (web). Expo/React Native, ScrollView/Pressable/Text/View, `expo-haptics` (for selection feedback), React Native Testing Library (mobile).

---

- **Component:** Tabs â€” controlled tab system with triggers (label + optional icon/badge) and consumer TabContent panes.
- **Targets:** Web + Mobile (web first).
- **Props (TS):**
  ```ts
  interface TabItem { value: string; label: string; badge?: number; icon?: React.ReactNode; }
  interface TabsProps {
    value: string;
    onChange: (value: string) => void;
    tabs: TabItem[];
    children: React.ReactNode; // TabContent panels supplied by caller
    fullWidth?: boolean; // optional stretch triggers
    size?: 'sm' | 'md';
    className?: string;
  }
  ```
- **Visual states:** default, hover (trigger), active (data-state=active styles), focus-visible ring, disabled (n/a), loading (n/a), error (n/a). Badge visible when provided.
- **Size variants:** `md` default padding/height matching shadcn TabsList; `sm` uses reduced height/gap/padding.
- **Colors/tokens:** TabsList background on light (`bg-slate-100` equivalent), active trigger `bg-white text-primary` with subtle shadow/border; text `text-slate-700`; focus ring `ring-2 ring-primary/50`. Maintain design tokens (teal primary).
- **Accessibility:** Radix Tabs handles roles/aria; ensure `data-slot="tabs"` on root and `data-slot="tabs.trigger"` per trigger. Keyboard nav via Radix; ensure `TabsContent` exported. Mobile: set `accessibilityRole="tab"` and `accessibilityState`.
- **Dependencies:** `@/components/ui/tabs`, `@/components/ui/badge`, `@/lib/utils` cn helper, class-variance-authority for trigger sizing; mobile: `expo-haptics`, React Native core components.
- **SOLID compliance:**
  | Component | SRP | OCP | LSP | ISP | DIP |
  |-----------|-----|-----|-----|-----|-----|
  | Tabs (web) | Render tab triggers + wrap content | Variant classes via CVA, tabs via data | Controlled via value/onChange interchangeable | Props minimal (no unused) | Depends on abstractions (props, cva) |
  | TabContent export | Provide panel primitive | Consumers extend via children | Substitutable with TabsContent | Focused interface | Depends on shadcn abstraction |
  | Tabs (mobile) | Render scrollable tab bar | Styles extendable via StyleSheet | Same contract across platforms | Minimal props | Depends on handlers, not concrete UI |
- **Parallel sub-agent strategy:** (emulated) Web tests + implementation sequential; mobile work after web. Could parallelize code review if available, otherwise single flow.
- **Test strategy (TDD):** Web: triggers render labels/icons/badges, calls onChange with value, applies active class, size variant classes, fullWidth flex behavior, data-slot presence, renders children without error. Mobile: selection changes, haptic called, badge renders, active style applied.

### Task 1: Write failing web tests
**Files:**
- Create: `klard-web/src/__tests__/components/ui/tabs.test.tsx`
- Test: `pnpm --filter klard-web test src/__tests__/components/ui/tabs.test.tsx --run`

**Step 1: Write the failing test**
- Cases: renders triggers from tabs prop; badge content when provided; icon shown; onChange called with tab value; active trigger gets active class; size `sm` changes height; `fullWidth` makes triggers flex-1; data-slot attributes exist; renders children panel without crash when matching value.

**Step 2: Run test to verify it fails**
- Expect failures (component missing/not implemented).

### Task 2: Implement web Tabs component
**Files:**
- Create: `klard-web/src/components/ui/tabs.tsx`
- Modify: `klard-web/src/components/ui/index.ts`
- Test: `pnpm --filter klard-web test src/__tests__/components/ui/tabs.test.tsx --run`

**Step 1: Write minimal implementation**
- Use shadcn Tabs/TabsList/TabsTrigger/TabsContent export. Add CVA for size/fullWidth classes. Map tabs with badge/icon, add data-slot attributes, forward className, pass children through.

**Step 2: Run test to verify it passes**
- Keep green.

**Step 3: Refactor**
- Clean class names, ensure types explicit.

### Task 3: Write failing mobile tests (optional but planned)
**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/tabs.test.tsx`
- Test: `pnpm --filter klard-mobile test src/__tests__/components/ui/tabs.test.tsx --run`

**Step 1: Write failing test**
- Verify triggers render, onChange called, active style applied, badge shown, haptic fired on press.

**Step 2: Run test to verify it fails**

### Task 4: Implement mobile Tabs component
**Files:**
- Create: `klard-mobile/src/components/ui/tabs.tsx`
- Modify: `klard-mobile/src/components/ui/index.ts`
- Test: `pnpm --filter klard-mobile test src/__tests__/components/ui/tabs.test.tsx --run`

**Step 1: Implement minimal code**
- ScrollView horizontal bar, Pressable tabs, styles for active/inactive, optional badges/icons, call onChange/haptics, safe area padding.

**Step 2: Run test to verify it passes**
- Keep green; refactor if needed.

### Task 5: Verification and spec update
**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md` (mark DONE)
- Commands: `pnpm --filter klard-web test src/__tests__/components/ui/tabs.test.tsx --run`; `pnpm --filter klard-web exec tsc --noEmit`; `pnpm --filter klard-mobile test src/__tests__/components/ui/tabs.test.tsx --run` (if mobile built); optional lint.

**Step 1:** Run verification commands, capture outputs.
**Step 2:** Update marker to `<!-- DONE:3.4-tabs -->`.
**Step 3:** Prepare commit message suggestion `feat: add tabs component`.
