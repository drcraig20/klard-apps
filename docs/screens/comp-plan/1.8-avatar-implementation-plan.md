# 1.8 Avatar Component Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a production-ready Avatar component for both Web (Next.js + shadcn/ui) and Mobile (React Native + Expo) platforms with full TDD coverage.

**Architecture:** Web uses shadcn/ui Avatar primitives with Radix UI. Mobile uses expo-image with fallback state handling. Both support size variants, shape options, and graceful fallback for missing/errored images.

**Tech Stack:**
- Web: Next.js 16, React 19, TypeScript strict, Tailwind CSS 4, @radix-ui/react-avatar
- Mobile: React Native, Expo SDK 54, TypeScript strict, expo-image

---

## Pre-Implementation Checklist

Before starting, verify these skills are loaded:
- [ ] `superpowers:test-driven-development` - TDD workflow
- [ ] `superpowers:testing-anti-patterns` - Avoid common test mistakes
- [ ] `solid-design-principles` - SOLID compliance

---

## Component Specification

### Props Interface

```typescript
// Web
interface AvatarProps {
  src?: string;
  alt: string;
  fallback: string;
  size: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  shape?: 'circle' | 'square';
  className?: string;
}

// Mobile
interface AvatarProps {
  src?: string;
  alt: string;
  fallback: string;
  size: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  shape?: 'circle' | 'square';
  style?: StyleProp<ViewStyle>;
}
```

### Size Mapping

| Size | Web (Tailwind) | Mobile (px) |
|------|----------------|-------------|
| xs | h-6 w-6 text-xs | 24px |
| sm | h-8 w-8 text-sm | 32px |
| md | h-10 w-10 text-base | 40px |
| lg | h-12 w-12 text-lg | 48px |
| xl | h-16 w-16 text-xl | 64px |

### Default Colors (Klard Design System)

- Fallback background: `#D5F5F4` (teal-100)
- Fallback text: `#0D7C7A` (teal-700)

---

## SOLID Compliance

| Principle | Implementation |
|-----------|----------------|
| **SRP** | Avatar only displays image with fallback - no business logic |
| **OCP** | Size/shape variants via props, no modification needed |
| **LSP** | All size/shape values produce valid avatars |
| **ISP** | Minimal interface with only necessary props |
| **DIP** | Component depends on abstract size/shape types, not concrete dimensions |

---

## Dependencies

### Web
- `@radix-ui/react-avatar` - Avatar primitives (install via shadcn)
- `@/lib/utils` - cn utility (already exists)

### Mobile
- `expo-image` - Image with caching and blurhash (check if installed)
- No additional dependencies needed if expo-image is present

---

# PART 1: WEB IMPLEMENTATION

## Task 1: Install shadcn/ui Avatar

**Files:**
- Create: `klard-web/src/components/ui/avatar.tsx` (via CLI)

**Step 1: Run shadcn CLI to add avatar**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-web
npx shadcn@latest add avatar
```

**Step 2: Verify installation**

```bash
ls -la /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-web/src/components/ui/avatar.tsx
```

Expected: File exists

---

## Task 2: Write Failing Tests for Avatar Rendering

**Files:**
- Create: `klard-web/src/__tests__/components/ui/avatar.test.tsx`

**Step 1: Create test file with rendering tests**

```tsx
/**
 * Tests for Avatar Component
 *
 * TDD: Write failing tests first, then implement to pass.
 * Tests verify: rendering, sizes, shapes, fallback, accessibility
 */

import { describe, it, expect } from 'vitest';
import { render, screen } from '@testing-library/react';
import { Avatar } from '@/components/ui/avatar';

describe('Avatar', () => {
  describe('Rendering', () => {
    it('should render fallback text when no src provided', () => {
      render(<Avatar alt="John Doe" fallback="JD" size="md" />);

      expect(screen.getByText('JD')).toBeInTheDocument();
    });

    it('should render with data-slot attribute for avatar root', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar).toBeInTheDocument();
    });

    it('should render with data-slot attribute for fallback', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const fallback = container.querySelector('[data-slot="avatar-fallback"]');
      expect(fallback).toBeInTheDocument();
    });
  });
});
```

**Step 2: Run tests to verify they fail**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps
pnpm --filter klard-web test src/__tests__/components/ui/avatar.test.tsx --run
```

Expected: FAIL - Avatar component doesn't exist yet or doesn't match expected structure

---

## Task 3: Write Failing Tests for Size Variants

**Files:**
- Modify: `klard-web/src/__tests__/components/ui/avatar.test.tsx`

**Step 1: Add size tests**

```tsx
  describe('Sizes', () => {
    it('should apply xs size classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="xs" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toMatch(/h-6/);
      expect(avatar?.className).toMatch(/w-6/);
    });

    it('should apply sm size classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="sm" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toMatch(/h-8/);
      expect(avatar?.className).toMatch(/w-8/);
    });

    it('should apply md size classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toMatch(/h-10/);
      expect(avatar?.className).toMatch(/w-10/);
    });

    it('should apply lg size classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="lg" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toMatch(/h-12/);
      expect(avatar?.className).toMatch(/w-12/);
    });

    it('should apply xl size classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="xl" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toMatch(/h-16/);
      expect(avatar?.className).toMatch(/w-16/);
    });
  });
```

**Step 2: Run tests to verify they fail**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/avatar.test.tsx --run
```

Expected: FAIL - Size prop not implemented

---

## Task 4: Write Failing Tests for Shape and Image

**Files:**
- Modify: `klard-web/src/__tests__/components/ui/avatar.test.tsx`

**Step 1: Add shape and image tests**

```tsx
  describe('Shape', () => {
    it('should render circle shape by default (rounded-full)', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toContain('rounded-full');
      expect(avatar?.className).not.toContain('rounded-lg');
    });

    it('should render square shape when specified (rounded-lg)', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" shape="square" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toContain('rounded-lg');
    });
  });

  describe('Image', () => {
    it('should render image when src is provided', () => {
      render(
        <Avatar
          src="https://example.com/avatar.jpg"
          alt="John Doe"
          fallback="JD"
          size="md"
        />
      );

      const img = screen.getByRole('img');
      expect(img).toHaveAttribute('alt', 'John Doe');
    });
  });

  describe('Klard Design System', () => {
    it('should apply teal-100 background to fallback', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const fallback = container.querySelector('[data-slot="avatar-fallback"]');
      expect(fallback?.className).toContain('bg-teal-100');
    });

    it('should apply teal-700 text color to fallback', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" />
      );

      const fallback = container.querySelector('[data-slot="avatar-fallback"]');
      expect(fallback?.className).toContain('text-teal-700');
    });
  });

  describe('Custom className', () => {
    it('should merge custom className with default classes', () => {
      const { container } = render(
        <Avatar alt="User" fallback="U" size="md" className="custom-class" />
      );

      const avatar = container.querySelector('[data-slot="avatar"]');
      expect(avatar?.className).toContain('custom-class');
      expect(avatar?.className).toContain('rounded-full');
    });
  });
```

**Step 2: Run all tests to verify they fail**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/avatar.test.tsx --run
```

Expected: Multiple FAIL

---

## Task 5: Implement Avatar Component

**Files:**
- Modify: `klard-web/src/components/ui/avatar.tsx`

**Step 1: Replace shadcn default with Klard Avatar**

```tsx
'use client';

import * as React from 'react';
import * as AvatarPrimitive from '@radix-ui/react-avatar';

import { cn } from '@/lib/utils';

const sizeMap = {
  xs: 'h-6 w-6 text-xs',
  sm: 'h-8 w-8 text-sm',
  md: 'h-10 w-10 text-base',
  lg: 'h-12 w-12 text-lg',
  xl: 'h-16 w-16 text-xl',
} as const;

export type AvatarSize = keyof typeof sizeMap;
export type AvatarShape = 'circle' | 'square';

export interface AvatarProps {
  src?: string;
  alt: string;
  fallback: string;
  size: AvatarSize;
  shape?: AvatarShape;
  className?: string;
}

function Avatar({
  src,
  alt,
  fallback,
  size,
  shape = 'circle',
  className,
}: AvatarProps) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        'relative flex shrink-0 overflow-hidden',
        sizeMap[size],
        shape === 'circle' ? 'rounded-full' : 'rounded-lg',
        className
      )}
    >
      {src && (
        <AvatarPrimitive.Image
          src={src}
          alt={alt}
          className="aspect-square h-full w-full object-cover"
        />
      )}
      <AvatarPrimitive.Fallback
        data-slot="avatar-fallback"
        className={cn(
          'flex h-full w-full items-center justify-center bg-teal-100 text-teal-700 font-medium',
          shape === 'circle' ? 'rounded-full' : 'rounded-lg'
        )}
      >
        {fallback}
      </AvatarPrimitive.Fallback>
    </AvatarPrimitive.Root>
  );
}

export { Avatar };
```

**Step 2: Run tests to verify they pass**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/avatar.test.tsx --run
```

Expected: All tests PASS

---

## Task 6: Export Avatar from Index

**Files:**
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Add Avatar export**

Add this line to the exports:

```typescript
export { Avatar, type AvatarProps, type AvatarSize, type AvatarShape } from './avatar';
```

**Step 2: Verify TypeScript compiles**

```bash
pnpm --filter klard-web exec tsc --noEmit
```

Expected: No TypeScript errors

**Step 3: Commit Web implementation**

```bash
git add klard-web/src/components/ui/avatar.tsx klard-web/src/components/ui/index.ts klard-web/src/__tests__/components/ui/avatar.test.tsx
git commit -m "feat(web): add Avatar component with TDD

- Add Avatar component using Radix UI primitives
- Support xs/sm/md/lg/xl sizes and circle/square shapes
- Klard teal-100/700 fallback colors
- Comprehensive test coverage"
```

---

# PART 2: MOBILE IMPLEMENTATION

## Task 7: Verify expo-image is Installed

**Step 1: Check package.json**

```bash
grep "expo-image" /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-mobile/package.json
```

**Step 2: Install if not present**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-mobile
npx expo install expo-image
```

Expected: expo-image in dependencies

---

## Task 8: Write Failing Tests for Mobile Avatar Rendering

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/Avatar.test.tsx`

**Step 1: Create test file with rendering tests**

```tsx
/**
 * Tests for Avatar Component (Mobile)
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import React from 'react';
import { render, screen } from '@testing-library/react-native';
import { Avatar } from '@/components/ui/Avatar';

// Mock expo-image
jest.mock('expo-image', () => ({
  Image: jest.fn(({ testID, style, accessibilityLabel }) => {
    const React = require('react');
    const { View } = require('react-native');
    return <View testID={testID} style={style} accessibilityLabel={accessibilityLabel} />;
  }),
}));

// Mock hooks
jest.mock('@/hooks', () => ({
  useThemeColors: () => ({
    primary: '#0D7C7A',
    muted: '#F1F5F9',
  }),
}));

describe('Avatar', () => {
  describe('Rendering', () => {
    it('should render avatar container', () => {
      render(<Avatar alt="John Doe" fallback="JD" size="md" />);

      expect(screen.getByTestId('avatar-container')).toBeTruthy();
    });

    it('should render fallback text when no src provided', () => {
      render(<Avatar alt="John Doe" fallback="JD" size="md" />);

      expect(screen.getByText('JD')).toBeTruthy();
    });

    it('should have accessibility label', () => {
      render(<Avatar alt="John Doe" fallback="JD" size="md" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.accessibilityLabel).toBe('John Doe');
    });

    it('should have image accessibility role', () => {
      render(<Avatar alt="John Doe" fallback="JD" size="md" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.accessibilityRole).toBe('image');
    });
  });
});
```

**Step 2: Run tests to verify they fail**

```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps
pnpm --filter klard-mobile test src/__tests__/components/ui/Avatar.test.tsx --run
```

Expected: FAIL - Avatar component doesn't exist

---

## Task 9: Write Failing Tests for Mobile Size Variants

**Files:**
- Modify: `klard-mobile/src/__tests__/components/ui/Avatar.test.tsx`

**Step 1: Add size tests**

```tsx
  describe('Sizes', () => {
    it('should apply xs dimensions (24px)', () => {
      render(<Avatar alt="User" fallback="U" size="xs" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style).toMatchObject({
        width: 24,
        height: 24,
      });
    });

    it('should apply sm dimensions (32px)', () => {
      render(<Avatar alt="User" fallback="U" size="sm" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style).toMatchObject({
        width: 32,
        height: 32,
      });
    });

    it('should apply md dimensions (40px)', () => {
      render(<Avatar alt="User" fallback="U" size="md" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style).toMatchObject({
        width: 40,
        height: 40,
      });
    });

    it('should apply lg dimensions (48px)', () => {
      render(<Avatar alt="User" fallback="U" size="lg" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style).toMatchObject({
        width: 48,
        height: 48,
      });
    });

    it('should apply xl dimensions (64px)', () => {
      render(<Avatar alt="User" fallback="U" size="xl" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style).toMatchObject({
        width: 64,
        height: 64,
      });
    });
  });
```

**Step 2: Run tests to verify they fail**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/Avatar.test.tsx --run
```

Expected: FAIL - Size prop not implemented

---

## Task 10: Write Failing Tests for Mobile Shape and Image

**Files:**
- Modify: `klard-mobile/src/__tests__/components/ui/Avatar.test.tsx`

**Step 1: Add shape and image tests**

```tsx
  describe('Shape', () => {
    it('should apply circle border radius by default (half of dimension)', () => {
      render(<Avatar alt="User" fallback="U" size="md" />);

      const container = screen.getByTestId('avatar-container');
      // md = 40px, so borderRadius should be 20
      expect(container.props.style.borderRadius).toBe(20);
    });

    it('should apply square border radius when specified (8px)', () => {
      render(<Avatar alt="User" fallback="U" size="md" shape="square" />);

      const container = screen.getByTestId('avatar-container');
      expect(container.props.style.borderRadius).toBe(8);
    });
  });

  describe('Image', () => {
    it('should render image when src is provided', () => {
      render(
        <Avatar
          src="https://example.com/avatar.jpg"
          alt="John Doe"
          fallback="JD"
          size="md"
        />
      );

      expect(screen.getByTestId('avatar-image')).toBeTruthy();
    });

    it('should not render fallback when src is provided', () => {
      render(
        <Avatar
          src="https://example.com/avatar.jpg"
          alt="John Doe"
          fallback="JD"
          size="md"
        />
      );

      expect(screen.queryByText('JD')).toBeNull();
    });
  });
```

**Step 2: Run all tests to verify they fail**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/Avatar.test.tsx --run
```

Expected: Multiple FAIL

---

## Task 11: Implement Mobile Avatar Component

**Files:**
- Create: `klard-mobile/src/components/ui/Avatar/Avatar.tsx`
- Create: `klard-mobile/src/components/ui/Avatar/avatar.styles.ts`
- Create: `klard-mobile/src/components/ui/Avatar/index.ts`

**Step 1: Create styles file**

```typescript
// klard-mobile/src/components/ui/Avatar/avatar.styles.ts
import { StyleSheet } from 'react-native';

export const styles = StyleSheet.create({
  container: {
    overflow: 'hidden',
    alignItems: 'center',
    justifyContent: 'center',
  },
  image: {
    width: '100%',
    height: '100%',
  },
  fallback: {
    width: '100%',
    height: '100%',
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: '#D5F5F4', // teal-100
  },
  fallbackText: {
    fontWeight: '500',
    color: '#0D7C7A', // teal-700
  },
  xsText: { fontSize: 10 },
  smText: { fontSize: 12 },
  mdText: { fontSize: 14 },
  lgText: { fontSize: 16 },
  xlText: { fontSize: 20 },
});
```

**Step 2: Create Avatar component**

```typescript
// klard-mobile/src/components/ui/Avatar/Avatar.tsx
import { useState } from 'react';
import { View, Text, type StyleProp, type ViewStyle } from 'react-native';
import { Image } from 'expo-image';
import { useThemeColors } from '@/hooks';
import { styles } from './avatar.styles';

const sizeMap = {
  xs: 24,
  sm: 32,
  md: 40,
  lg: 48,
  xl: 64,
} as const;

const textStyleMap = {
  xs: styles.xsText,
  sm: styles.smText,
  md: styles.mdText,
  lg: styles.lgText,
  xl: styles.xlText,
} as const;

export type AvatarSize = keyof typeof sizeMap;
export type AvatarShape = 'circle' | 'square';

export interface AvatarProps {
  src?: string;
  alt: string;
  fallback: string;
  size: AvatarSize;
  shape?: AvatarShape;
  style?: StyleProp<ViewStyle>;
}

const BLURHASH = 'L6PZfSi_.AyE_3t7t7R**0o#DgR4';

export function Avatar({
  src,
  alt,
  fallback,
  size,
  shape = 'circle',
  style,
}: AvatarProps) {
  const colors = useThemeColors();
  const [hasError, setHasError] = useState(false);

  const dimension = sizeMap[size];
  const borderRadius = shape === 'circle' ? dimension / 2 : 8;
  const showFallback = !src || hasError;

  return (
    <View
      testID="avatar-container"
      accessibilityLabel={alt}
      accessibilityRole="image"
      style={[
        styles.container,
        {
          width: dimension,
          height: dimension,
          borderRadius,
          backgroundColor: colors.muted,
        },
        style,
      ]}
    >
      {!showFallback ? (
        <Image
          testID="avatar-image"
          source={src}
          style={[styles.image, { borderRadius }]}
          contentFit="cover"
          placeholder={{ blurhash: BLURHASH }}
          transition={200}
          onError={() => setHasError(true)}
          accessibilityLabel={alt}
        />
      ) : (
        <View
          testID="avatar-fallback"
          style={[styles.fallback, { borderRadius }]}
        >
          <Text style={[styles.fallbackText, textStyleMap[size]]}>
            {fallback}
          </Text>
        </View>
      )}
    </View>
  );
}
```

**Step 3: Create index file**

```typescript
// klard-mobile/src/components/ui/Avatar/index.ts
export { Avatar, type AvatarProps, type AvatarSize, type AvatarShape } from './Avatar';
```

**Step 4: Run tests to verify they pass**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/Avatar.test.tsx --run
```

Expected: All tests PASS

---

## Task 12: Export Mobile Avatar from Index

**Files:**
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Add Avatar export**

Add this line to the exports:

```typescript
export { Avatar, type AvatarProps, type AvatarSize, type AvatarShape } from './Avatar';
```

**Step 2: Verify TypeScript compiles**

```bash
pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No TypeScript errors

**Step 3: Commit Mobile implementation**

```bash
git add klard-mobile/src/components/ui/Avatar/ klard-mobile/src/components/ui/index.ts klard-mobile/src/__tests__/components/ui/Avatar.test.tsx
git commit -m "feat(mobile): add Avatar component with TDD

- Add Avatar component using expo-image
- Support xs/sm/md/lg/xl sizes and circle/square shapes
- Blurhash placeholder for smooth loading
- Error state fallback to initials
- Comprehensive test coverage"
```

---

# PART 3: VERIFICATION & COMPLETION

## Task 13: Run Full Test Suite

**Step 1: Run all web tests**

```bash
pnpm --filter klard-web test --run
```

Expected: All tests PASS

**Step 2: Run all mobile tests**

```bash
pnpm --filter klard-mobile test --run
```

Expected: All tests PASS

**Step 3: Run TypeScript check on both**

```bash
pnpm --filter klard-web exec tsc --noEmit && pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No TypeScript errors

---

## Task 14: Verification Checklist

Complete this checklist before marking component as DONE:

**Web Avatar:**
- [ ] Component renders without errors
- [ ] All 5 sizes functional (xs, sm, md, lg, xl)
- [ ] Both shapes functional (circle, square)
- [ ] Image renders when src provided
- [ ] Fallback renders when no src or on error
- [ ] Custom className merges correctly
- [ ] Klard teal-100/700 colors for fallback
- [ ] TypeScript compiles with no errors
- [ ] All tests passing
- [ ] Exported from index.ts

**Mobile Avatar:**
- [ ] Component renders without errors
- [ ] All 5 sizes functional (xs, sm, md, lg, xl)
- [ ] Both shapes functional (circle, square)
- [ ] expo-image renders when src provided
- [ ] Fallback renders when no src or on error
- [ ] Blurhash placeholder works
- [ ] Accessibility: label and role set
- [ ] TypeScript compiles with no errors
- [ ] All tests passing
- [ ] Exported from index.ts

---

## Task 15: Mark Component as DONE

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md`

**Step 1: Update spec marker**

Replace:
```
<!-- IN-PROGRESS:1.8-avatar -->
```

With:
```
<!-- DONE:1.8-avatar -->
```

**Step 2: Final commit**

```bash
git add docs/screens/batch/Klard_Component_Specifications.md
git commit -m "docs: mark 1.8-avatar component as DONE"
```

---

## Summary

| Task | Platform | Description |
|------|----------|-------------|
| 1 | Web | Install shadcn/ui avatar |
| 2-4 | Web | Write failing tests (TDD RED phase) |
| 5 | Web | Implement Avatar component (TDD GREEN phase) |
| 6 | Web | Export from index.ts |
| 7 | Mobile | Verify expo-image installed |
| 8-10 | Mobile | Write failing tests (TDD RED phase) |
| 11 | Mobile | Implement Avatar component (TDD GREEN phase) |
| 12 | Mobile | Export from index.ts |
| 13 | Both | Run full test suite |
| 14 | Both | Verification checklist |
| 15 | Docs | Mark component as DONE |

**Total Tasks:** 15
**Estimated Time:** 30-45 minutes

---

## File Structure

### Web
```
klard-web/src/
├── components/ui/
│   ├── avatar.tsx           # Component
│   └── index.ts             # Export added
└── __tests__/components/ui/
    └── avatar.test.tsx      # Test file
```

### Mobile
```
klard-mobile/src/
├── components/ui/
│   ├── Avatar/
│   │   ├── Avatar.tsx       # Component
│   │   ├── avatar.styles.ts # Styles
│   │   └── index.ts         # Barrel export
│   └── index.ts             # Export added
└── __tests__/components/ui/
    └── Avatar.test.tsx      # Test file
```

---

## Execution Options

**Plan complete and saved to `docs/screens/comp-plan/1.8-avatar-implementation-plan.md`.**

**Two execution options:**

1. **Subagent-Driven (this session)** - Dispatch fresh subagent per task, review between tasks, fast iteration

2. **Parallel Session (separate)** - Open new session with executing-plans, batch execution with checkpoints

**Which approach?**