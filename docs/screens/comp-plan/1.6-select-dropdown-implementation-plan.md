# 1.6 Select/Dropdown Component Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Create a unified SelectField component for Web and Mobile that provides single selection from a list of options with label, error handling, and accessibility support.

**Architecture:**
- Web: Use shadcn/ui Select primitive (Radix UI) with a composed SelectField wrapper
- Mobile: Use `@react-native-picker/picker` with modal presentation for consistent cross-platform UX
- Both platforms follow identical props interface for consistency

**Tech Stack:**
- Web: @radix-ui/react-select (via shadcn), lucide-react, Tailwind CSS
- Mobile: @react-native-picker/picker, expo-haptics, React Native Modal

---

## SOLID Compliance

| Component | SRP | OCP | LSP | ISP | DIP |
|-----------|-----|-----|-----|-----|-----|
| SelectField (Web) | Renders select with label/error | Extends via className prop | Handles all SelectProps | Single focused interface | Depends on Select primitive abstraction |
| SelectField (Mobile) | Renders select with label/error | Extends via style prop | Handles all SelectProps | Single focused interface | Depends on Picker abstraction |

### Principle Applications
- **SRP:** SelectField handles composition only; styling separate from behavior
- **OCP:** Extensible via className/style props without modification
- **LSP:** Both platform components accept same props interface
- **ISP:** Single SelectFieldProps interface - no unused methods
- **DIP:** Components depend on primitive abstractions, not implementations

---

## Test Strategy (TDD)

### Tests to Write First (RED phase):

**Web Tests:**
1. Renders select without label
2. Renders select with label
3. Renders select with placeholder
4. Displays options correctly
5. Handles value selection
6. Shows error state and message
7. Disabled state prevents interaction
8. Has accessible label association
9. Renders icons in options (if provided)

**Mobile Tests:**
1. Renders select trigger without label
2. Renders select trigger with label
3. Shows placeholder when no value selected
4. Opens modal on press
5. Handles value selection
6. Shows error state and message
7. Disabled state prevents interaction
8. Haptic feedback triggers on selection
9. Has correct accessibility role and state

---

## Task 1: Install shadcn/ui Select component (Web)

**Files:**
- Create: `klard-web/src/components/ui/select.tsx`

**Step 1: Install Select via shadcn CLI**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-web && npx shadcn@latest add select
```

Expected: Select component added to components/ui/

**Step 2: Verify installation**

Check that `klard-web/src/components/ui/select.tsx` exists.

---

## Task 2: Install @react-native-picker/picker (Mobile)

**Files:**
- Modify: `klard-mobile/package.json`

**Step 1: Install picker package**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-mobile add @react-native-picker/picker
```

Expected: Package added to dependencies

**Step 2: Verify installation**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps/klard-mobile && cat package.json | grep picker
```

Expected: `"@react-native-picker/picker": "^2.x.x"` in dependencies

---

## Task 3: Write failing tests for Web SelectField (TDD RED)

**Files:**
- Create: `klard-web/src/__tests__/components/ui/select-field.test.tsx`

**Step 1: Write the failing tests**

```tsx
/**
 * Tests for SelectField Component
 *
 * These tests verify:
 * 1. Renders with all props (label, placeholder, error)
 * 2. Option display and selection
 * 3. Disabled state
 * 4. Error message display
 * 5. Accessibility attributes
 * 6. Icon support in options
 */

import { describe, it, expect, vi } from 'vitest';
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { SelectField } from '@/components/ui/select-field';

const mockOptions = [
  { value: 'apple', label: 'Apple' },
  { value: 'banana', label: 'Banana' },
  { value: 'cherry', label: 'Cherry' },
];

describe('SelectField', () => {
  describe('Rendering', () => {
    it('should render select without label', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      expect(screen.getByRole('combobox')).toBeTruthy();
    });

    it('should render select with label', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          label="Select a fruit"
        />
      );

      expect(screen.getByText('Select a fruit')).toBeTruthy();
    });

    it('should render placeholder when no value selected', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          placeholder="Choose..."
        />
      );

      expect(screen.getByText('Choose...')).toBeTruthy();
    });

    it('should display selected value', () => {
      render(
        <SelectField
          value="apple"
          onChange={() => {}}
          options={mockOptions}
        />
      );

      expect(screen.getByText('Apple')).toBeTruthy();
    });
  });

  describe('Selection', () => {
    it('should call onChange when option is selected', async () => {
      const handleChange = vi.fn();
      const user = userEvent.setup();

      render(
        <SelectField
          value=""
          onChange={handleChange}
          options={mockOptions}
          placeholder="Select..."
        />
      );

      // Open the select
      await user.click(screen.getByRole('combobox'));

      // Select an option
      await user.click(screen.getByText('Banana'));

      expect(handleChange).toHaveBeenCalledWith('banana');
    });

    it('should display all options when opened', async () => {
      const user = userEvent.setup();

      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      await user.click(screen.getByRole('combobox'));

      expect(screen.getByText('Apple')).toBeTruthy();
      expect(screen.getByText('Banana')).toBeTruthy();
      expect(screen.getByText('Cherry')).toBeTruthy();
    });
  });

  describe('Disabled State', () => {
    it('should be disabled when disabled prop is true', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          disabled
        />
      );

      expect(screen.getByRole('combobox')).toBeDisabled();
    });

    it('should not open when disabled', async () => {
      const user = userEvent.setup();

      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          disabled
        />
      );

      await user.click(screen.getByRole('combobox'));

      // Options should not be visible
      expect(screen.queryByText('Apple')).toBeNull();
    });
  });

  describe('Error State', () => {
    it('should display error message', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          error="Selection is required"
        />
      );

      expect(screen.getByText('Selection is required')).toBeTruthy();
    });

    it('should have error role on error message', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          error="Selection is required"
        />
      );

      expect(screen.getByRole('alert')).toBeTruthy();
    });

    it('should have error styling on trigger', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          error="Selection is required"
        />
      );

      const trigger = screen.getByRole('combobox');
      expect(trigger.className).toContain('border-red');
    });
  });

  describe('Disabled Options', () => {
    it('should not allow selecting disabled options', async () => {
      const handleChange = vi.fn();
      const user = userEvent.setup();
      const optionsWithDisabled = [
        ...mockOptions,
        { value: 'grape', label: 'Grape', disabled: true },
      ];

      render(
        <SelectField
          value=""
          onChange={handleChange}
          options={optionsWithDisabled}
        />
      );

      await user.click(screen.getByRole('combobox'));

      const grapeOption = screen.getByText('Grape');
      await user.click(grapeOption);

      expect(handleChange).not.toHaveBeenCalledWith('grape');
    });
  });

  describe('Accessibility', () => {
    it('should link label to select via htmlFor', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          label="Fruit"
        />
      );

      const label = screen.getByText('Fruit');
      const trigger = screen.getByRole('combobox');

      // The label should be associated with the trigger
      expect(label.getAttribute('for')).toBe(trigger.getAttribute('id'));
    });

    it('should have aria-expanded attribute', async () => {
      const user = userEvent.setup();

      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      const trigger = screen.getByRole('combobox');
      expect(trigger.getAttribute('aria-expanded')).toBe('false');

      await user.click(trigger);

      await waitFor(() => {
        expect(trigger.getAttribute('aria-expanded')).toBe('true');
      });
    });
  });

  describe('Icons in Options', () => {
    it('should render icon in options when provided', async () => {
      const user = userEvent.setup();
      const optionsWithIcons = [
        { value: 'apple', label: 'Apple', icon: <span data-testid="apple-icon">üçé</span> },
        { value: 'banana', label: 'Banana', icon: <span data-testid="banana-icon">üçå</span> },
      ];

      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={optionsWithIcons}
        />
      );

      await user.click(screen.getByRole('combobox'));

      expect(screen.getByTestId('apple-icon')).toBeTruthy();
      expect(screen.getByTestId('banana-icon')).toBeTruthy();
    });
  });
});
```

**Step 2: Run tests to verify they fail**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-web test src/__tests__/components/ui/select-field.test.tsx
```

Expected: FAIL - Module not found or component not exported

---

## Task 4: Implement Web SelectField component (TDD GREEN)

**Files:**
- Create: `klard-web/src/components/ui/select-field.tsx`
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Create SelectField component**

```tsx
'use client';

import { useId } from 'react';
import { ChevronDown } from 'lucide-react';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { cn } from '@/lib/utils';

export interface SelectOption {
  value: string;
  label: string;
  icon?: React.ReactNode;
  disabled?: boolean;
}

export interface SelectFieldProps {
  /** Currently selected value */
  value: string;
  /** Called when selection changes */
  onChange: (value: string) => void;
  /** Available options */
  options: SelectOption[];
  /** Placeholder text when no value selected */
  placeholder?: string;
  /** Label text displayed above the select */
  label?: string;
  /** Error message - displays in red below select */
  error?: string;
  /** Disables the select */
  disabled?: boolean;
  /** Additional className for the container */
  className?: string;
  /** Custom id for accessibility */
  id?: string;
}

export function SelectField({
  value,
  onChange,
  options,
  placeholder = 'Select...',
  label,
  error,
  disabled = false,
  className,
  id: providedId,
}: SelectFieldProps) {
  const generatedId = useId();
  const id = providedId ?? generatedId;
  const errorId = `${id}-error`;

  return (
    <div className={cn('w-full', className)}>
      {label && (
        <label
          htmlFor={id}
          className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
        >
          {label}
        </label>
      )}
      <Select
        value={value}
        onValueChange={onChange}
        disabled={disabled}
      >
        <SelectTrigger
          id={id}
          aria-describedby={error ? errorId : undefined}
          className={cn(
            'w-full h-12 px-4 text-base',
            'bg-white dark:bg-slate-900',
            'border rounded-xl',
            'transition-all duration-150',
            'focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary',
            !error && 'border-slate-300 dark:border-slate-700 hover:border-slate-400 dark:hover:border-slate-600',
            error && 'border-red-500 focus:ring-red-500/30 focus:border-red-500',
            disabled && 'opacity-50 cursor-not-allowed bg-slate-50 dark:bg-slate-800'
          )}
        >
          <SelectValue placeholder={placeholder} />
        </SelectTrigger>
        <SelectContent>
          {options.map((option) => (
            <SelectItem
              key={option.value}
              value={option.value}
              disabled={option.disabled}
            >
              <div className="flex items-center gap-2">
                {option.icon}
                {option.label}
              </div>
            </SelectItem>
          ))}
        </SelectContent>
      </Select>
      {error && (
        <p
          id={errorId}
          className="mt-2 text-sm text-red-500"
          role="alert"
        >
          {error}
        </p>
      )}
    </div>
  );
}
```

**Step 2: Export from index**

Add to `klard-web/src/components/ui/index.ts`:

```ts
export { SelectField, type SelectFieldProps, type SelectOption } from './select-field';
```

**Step 3: Run tests to verify they pass**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-web test src/__tests__/components/ui/select-field.test.tsx
```

Expected: All tests PASS

---

## Task 5: Write failing tests for Mobile SelectField (TDD RED)

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/SelectField.test.tsx`

**Step 1: Write the failing tests**

```tsx
/**
 * Tests for SelectField Component (Mobile)
 */

import React from 'react';
import { render, fireEvent, screen, waitFor } from '@testing-library/react-native';
import { SelectField } from '@/components/ui/SelectField';

// Mock expo-haptics
jest.mock('expo-haptics', () => ({
  impactAsync: jest.fn(),
  ImpactFeedbackStyle: {
    Light: 'light',
    Medium: 'medium',
    Heavy: 'heavy',
  },
}));

const mockOptions = [
  { value: 'apple', label: 'Apple' },
  { value: 'banana', label: 'Banana' },
  { value: 'cherry', label: 'Cherry' },
];

describe('SelectField', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  describe('Rendering', () => {
    it('should render select trigger without label', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      expect(screen.getByTestId('select-trigger')).toBeTruthy();
    });

    it('should render select with label', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          label="Select a fruit"
        />
      );

      expect(screen.getByText('Select a fruit')).toBeTruthy();
    });

    it('should render placeholder when no value selected', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          placeholder="Choose..."
        />
      );

      expect(screen.getByText('Choose...')).toBeTruthy();
    });

    it('should display selected value label', () => {
      render(
        <SelectField
          value="apple"
          onChange={() => {}}
          options={mockOptions}
        />
      );

      expect(screen.getByText('Apple')).toBeTruthy();
    });
  });

  describe('Modal Interaction', () => {
    it('should open modal when trigger is pressed', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      fireEvent.press(screen.getByTestId('select-trigger'));

      // Modal should be visible with options
      expect(screen.getByTestId('select-modal')).toBeTruthy();
    });

    it('should display all options in modal', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      fireEvent.press(screen.getByTestId('select-trigger'));

      // All options should be visible
      expect(screen.getByText('Apple')).toBeTruthy();
      expect(screen.getByText('Banana')).toBeTruthy();
      expect(screen.getByText('Cherry')).toBeTruthy();
    });
  });

  describe('Selection', () => {
    it('should call onChange when option is selected', () => {
      const handleChange = jest.fn();

      render(
        <SelectField
          value=""
          onChange={handleChange}
          options={mockOptions}
        />
      );

      // Open modal
      fireEvent.press(screen.getByTestId('select-trigger'));

      // Select option
      fireEvent.press(screen.getByTestId('select-option-banana'));

      expect(handleChange).toHaveBeenCalledWith('banana');
    });

    it('should trigger haptic feedback on selection', () => {
      const Haptics = require('expo-haptics');
      const handleChange = jest.fn();

      render(
        <SelectField
          value=""
          onChange={handleChange}
          options={mockOptions}
        />
      );

      fireEvent.press(screen.getByTestId('select-trigger'));
      fireEvent.press(screen.getByTestId('select-option-apple'));

      expect(Haptics.impactAsync).toHaveBeenCalledWith(Haptics.ImpactFeedbackStyle.Light);
    });

    it('should close modal after selection', async () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
        />
      );

      fireEvent.press(screen.getByTestId('select-trigger'));
      fireEvent.press(screen.getByTestId('select-option-apple'));

      await waitFor(() => {
        expect(screen.queryByTestId('select-modal')).toBeNull();
      });
    });
  });

  describe('Disabled State', () => {
    it('should not open modal when disabled', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          disabled
        />
      );

      fireEvent.press(screen.getByTestId('select-trigger'));

      expect(screen.queryByTestId('select-modal')).toBeNull();
    });

    it('should have disabled styling', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          disabled
        />
      );

      const trigger = screen.getByTestId('select-trigger');
      expect(trigger.props.accessibilityState.disabled).toBe(true);
    });
  });

  describe('Error State', () => {
    it('should display error message', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          error="Selection is required"
        />
      );

      expect(screen.getByText('Selection is required')).toBeTruthy();
    });

    it('should have error styling on trigger', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          error="Selection is required"
        />
      );

      // The trigger container should reflect error state
      const trigger = screen.getByTestId('select-trigger');
      expect(trigger).toBeTruthy();
    });
  });

  describe('Accessibility', () => {
    it('should have correct accessibility role', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          label="Fruit"
        />
      );

      const trigger = screen.getByTestId('select-trigger');
      expect(trigger.props.accessibilityRole).toBe('combobox');
    });

    it('should have accessibility label', () => {
      render(
        <SelectField
          value=""
          onChange={() => {}}
          options={mockOptions}
          label="Fruit"
        />
      );

      const trigger = screen.getByTestId('select-trigger');
      expect(trigger.props.accessibilityLabel).toBe('Fruit');
    });
  });
});
```

**Step 2: Run tests to verify they fail**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-mobile test src/__tests__/components/ui/SelectField.test.tsx
```

Expected: FAIL - Module not found

---

## Task 6: Implement Mobile SelectField component (TDD GREEN)

**Files:**
- Create: `klard-mobile/src/components/ui/SelectField.tsx`
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Create SelectField component**

```tsx
import React, { useState } from 'react';
import {
  View,
  Text,
  Pressable,
  Modal,
  FlatList,
  StyleSheet,
  type StyleProp,
  type ViewStyle,
} from 'react-native';
import { Ionicons } from '@expo/vector-icons';
import * as Haptics from 'expo-haptics';

export interface SelectOption {
  value: string;
  label: string;
  icon?: React.ReactNode;
  disabled?: boolean;
}

export interface SelectFieldProps {
  /** Currently selected value */
  value: string;
  /** Called when selection changes */
  onChange: (value: string) => void;
  /** Available options */
  options: SelectOption[];
  /** Placeholder text when no value selected */
  placeholder?: string;
  /** Label text displayed above the select */
  label?: string;
  /** Error message - displays in red below select */
  error?: string;
  /** Disables the select */
  disabled?: boolean;
  /** Container style override */
  containerStyle?: StyleProp<ViewStyle>;
}

export function SelectField({
  value,
  onChange,
  options,
  placeholder = 'Select...',
  label,
  error,
  disabled = false,
  containerStyle,
}: SelectFieldProps) {
  const [isOpen, setIsOpen] = useState(false);

  const selectedOption = options.find((opt) => opt.value === value);
  const displayText = selectedOption?.label || placeholder;

  const handleOpen = () => {
    if (!disabled) {
      setIsOpen(true);
    }
  };

  const handleSelect = async (optionValue: string) => {
    await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
    onChange(optionValue);
    setIsOpen(false);
  };

  const handleClose = () => {
    setIsOpen(false);
  };

  const getBorderColor = () => {
    if (error) return colors.error;
    return colors.border;
  };

  return (
    <View style={[styles.container, containerStyle]}>
      {/* Label */}
      {label && (
        <Text style={[styles.label, disabled && styles.labelDisabled]}>
          {label}
        </Text>
      )}

      {/* Trigger */}
      <Pressable
        testID="select-trigger"
        onPress={handleOpen}
        disabled={disabled}
        accessibilityRole="combobox"
        accessibilityLabel={label}
        accessibilityState={{ disabled, expanded: isOpen }}
        style={[
          styles.trigger,
          { borderColor: getBorderColor() },
          disabled && styles.triggerDisabled,
        ]}
      >
        <Text
          style={[
            styles.triggerText,
            !selectedOption && styles.placeholder,
            disabled && styles.textDisabled,
          ]}
        >
          {displayText}
        </Text>
        <Ionicons
          name="chevron-down"
          size={20}
          color={disabled ? colors.icon : colors.textSecondary}
        />
      </Pressable>

      {/* Error message */}
      {error && (
        <Text style={styles.error} accessibilityRole="alert">
          {error}
        </Text>
      )}

      {/* Selection Modal */}
      <Modal
        visible={isOpen}
        transparent
        animationType="fade"
        onRequestClose={handleClose}
        testID="select-modal"
      >
        <Pressable style={styles.overlay} onPress={handleClose}>
          <View style={styles.modalContent}>
            <View style={styles.modalHeader}>
              <Text style={styles.modalTitle}>{label || 'Select'}</Text>
              <Pressable onPress={handleClose} style={styles.closeButton}>
                <Ionicons name="close" size={24} color={colors.text} />
              </Pressable>
            </View>
            <FlatList
              data={options}
              keyExtractor={(item) => item.value}
              renderItem={({ item }) => (
                <Pressable
                  testID={`select-option-${item.value}`}
                  onPress={() => !item.disabled && handleSelect(item.value)}
                  disabled={item.disabled}
                  style={[
                    styles.option,
                    item.value === value && styles.optionSelected,
                    item.disabled && styles.optionDisabled,
                  ]}
                >
                  {item.icon && <View style={styles.optionIcon}>{item.icon}</View>}
                  <Text
                    style={[
                      styles.optionText,
                      item.value === value && styles.optionTextSelected,
                      item.disabled && styles.optionTextDisabled,
                    ]}
                  >
                    {item.label}
                  </Text>
                  {item.value === value && (
                    <Ionicons name="checkmark" size={20} color={colors.primary} />
                  )}
                </Pressable>
              )}
            />
          </View>
        </Pressable>
      </Modal>
    </View>
  );
}

// Color constants aligned with Klard design system
const colors = {
  primary: '#0D7C7A',
  error: '#DC2626',
  border: '#CBD5E1',
  placeholder: '#94A3B8',
  icon: '#64748B',
  text: '#0F172A',
  textSecondary: '#475569',
  background: '#FFFFFF',
  backgroundDisabled: '#F1F5F9',
  overlay: 'rgba(15, 23, 42, 0.5)',
};

const styles = StyleSheet.create({
  container: {
    width: '100%',
  },
  label: {
    fontSize: 14,
    fontWeight: '500',
    color: colors.textSecondary,
    marginBottom: 8,
  },
  labelDisabled: {
    opacity: 0.5,
  },
  trigger: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    backgroundColor: colors.background,
    borderWidth: 1,
    borderRadius: 12,
    height: 48,
    paddingHorizontal: 16,
  },
  triggerDisabled: {
    backgroundColor: colors.backgroundDisabled,
    opacity: 0.7,
  },
  triggerText: {
    flex: 1,
    fontSize: 16,
    color: colors.text,
  },
  placeholder: {
    color: colors.placeholder,
  },
  textDisabled: {
    color: colors.icon,
  },
  error: {
    fontSize: 14,
    color: colors.error,
    marginTop: 8,
  },
  overlay: {
    flex: 1,
    backgroundColor: colors.overlay,
    justifyContent: 'flex-end',
  },
  modalContent: {
    backgroundColor: colors.background,
    borderTopLeftRadius: 24,
    borderTopRightRadius: 24,
    maxHeight: '60%',
    paddingBottom: 32,
  },
  modalHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 20,
    paddingVertical: 16,
    borderBottomWidth: 1,
    borderBottomColor: '#E2E8F0',
  },
  modalTitle: {
    fontSize: 18,
    fontWeight: '600',
    color: colors.text,
  },
  closeButton: {
    padding: 4,
  },
  option: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingVertical: 16,
    borderBottomWidth: 1,
    borderBottomColor: '#F1F5F9',
  },
  optionSelected: {
    backgroundColor: '#F0FDFA',
  },
  optionDisabled: {
    opacity: 0.5,
  },
  optionIcon: {
    marginRight: 12,
  },
  optionText: {
    flex: 1,
    fontSize: 16,
    color: colors.text,
  },
  optionTextSelected: {
    color: colors.primary,
    fontWeight: '500',
  },
  optionTextDisabled: {
    color: colors.icon,
  },
});
```

**Step 2: Export from index**

Add to `klard-mobile/src/components/ui/index.ts`:

```ts
export { SelectField, type SelectFieldProps, type SelectOption } from './SelectField';
```

**Step 3: Run tests to verify they pass**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-mobile test src/__tests__/components/ui/SelectField.test.tsx
```

Expected: All tests PASS

---

## Task 7: TypeScript Verification

**Step 1: Run TypeScript check for web**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-web exec tsc --noEmit
```

Expected: No errors

**Step 2: Run TypeScript check for mobile**

Run:
```bash
cd /Users/drcraig/Desktop/PersonalProjects/klard-apps && pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No errors

---

## Task 8: Update Component Specification

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md`

**Step 1: Replace IN-PROGRESS with DONE marker**

Find:
```
<!-- COMPONENT:START:1.6-select-dropdown -->
<!-- IN-PROGRESS:1.6-select-dropdown -->
```

Replace with:
```
<!-- COMPONENT:START:1.6-select-dropdown -->
<!-- DONE:1.6-select-dropdown -->
```

---

## Verification Checklist

Before marking complete, verify:

- [ ] Web SelectField renders without errors
- [ ] Mobile SelectField renders without errors
- [ ] All props implemented and typed
- [ ] All states functional (default, selected, disabled, error)
- [ ] Accessibility attributes present
- [ ] TypeScript passes with no errors
- [ ] All tests passing (TDD cycle completed)
- [ ] Works on both platforms

---

## Parallel Sub-Agent Strategy

**Tasks that can run in parallel:**
- Task 1 (Web shadcn install) and Task 2 (Mobile picker install) - independent installs
- Task 3 (Web tests) and Task 5 (Mobile tests) - independent test files
- TypeScript checks for web and mobile after implementation

**Tasks that must be sequential:**
- Task 1 (install) ‚Üí Task 3 (web tests) ‚Üí Task 4 (web impl)
- Task 2 (install) ‚Üí Task 5 (mobile tests) ‚Üí Task 6 (mobile impl)
- All impl tasks ‚Üí Task 7 (TS verification) ‚Üí Task 8 (docs update)

---

## Summary

| Task | Description | Platform | TDD Phase |
|------|-------------|----------|-----------|
| 1 | Install shadcn/ui Select | Web | Setup |
| 2 | Install @react-native-picker/picker | Mobile | Setup |
| 3 | Write failing web tests | Web | RED |
| 4 | Implement web SelectField | Web | GREEN |
| 5 | Write failing mobile tests | Mobile | RED |
| 6 | Implement mobile SelectField | Mobile | GREEN |
| 7 | TypeScript verification | Both | Verify |
| 8 | Update specification | Docs | Complete |