# StatCard Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a production-ready StatCard component for displaying key metrics with label, value, optional trend indicators (up/down/neutral), icon support, and click handling across web and mobile platforms following Klard design tokens and accessibility rules.

**Architecture:** Card-based metric display using CVA for web variant management with shadcn Card primitives and StyleSheet for mobile. Web uses shadcn Card + CVA-based variants for size/trend/state styling, mobile uses StyleSheet + `useThemeColors` with Ionicons for trend indicators. Shared behavior kept minimal and props-driven to satisfy SRP/OCP, with dependency injection for icons and callbacks. Exports wired through existing index barrels. Supports three size variants (sm/md/lg) and optional muted tone for non-primary stats.

**Tech Stack:** Next.js 16 App Router, React 19, TypeScript (strict), Tailwind CSS 4 + shadcn/ui + CVA (web), Expo 54 + React Native + @expo/vector-icons Ionicons + expo-haptics (mobile), Vitest + Testing Library (web), jest-expo + React Native Testing Library (mobile).

---

- **Component:** StatCard â€” displays label/value with optional trend and icon; clickable for drill-down.
- **Targets:** Web + Mobile.
- **Props:**
  ```ts
  interface StatCardProps {
    label: string;
    value: string | number;
    trend?: { direction: 'up' | 'down' | 'neutral'; value: string };
    icon?: React.ReactNode;
    onClick?: () => void;
    size?: 'sm' | 'md' | 'lg'; // padding + icon/text scale
    muted?: boolean; // tone for non-primary stats
    className?/style?: overrides per platform;
  }
  ```
- **Visual States:** default, hover/focus (web), pressed/active, muted (reduced contrast), trend variants (up/success green, down/error red, neutral/slate).
- **Size Variants (exact):**
  - `sm`: padding 12px (py-3 px-4 web / 12 RN), text 14px, icon 16px
  - `md`: padding 16px (py-4 px-4 web / 16 RN), text 16px, icon 18px
  - `lg`: padding 20px (py-5 px-5 web / 20 RN), text 18px, icon 20px
- **Color Tokens:**
  - **Light:** bg `#FFFFFF`, border `rgba(15,23,42,0.08)`, text `#0F172A`, muted text `#475569`, primary accent `#0D7C7A`, success `#059669`, error `#DC2626`
  - **Dark:** bg `#1E293B`, border `rgba(148,163,184,0.18)`, text `#F8FAFC`, muted `#CBD5E1`, primary accent `#15B5B0`, success `#10B981`, error `#EF4444`
  - Use subtle glass/backdrop blur for elevated feel on web.
- **Accessibility:**
  - **Web:** role="button" when clickable, keyboard focus states, `aria-label` on trend icon via sr-only text, data-slot attributes for container/label/value/trend/icon.
  - **Mobile:** `accessible` + `accessibilityRole="button"` when onPress provided, `accessibilityLabel` combining label/value/trend; ensure touch target >= 44px height; RTL-safe layout.
- **Dependencies:**
  - Web: shadcn Card primitives, `cn` util, `class-variance-authority`, lucide-react icons (TrendingUp, TrendingDown, Minus)
  - Mobile: @expo/vector-icons/Ionicons, expo-haptics, `useThemeColors` hook (if available), `TouchableOpacity` or `Pressable` wrapper for clickable variant
- **SOLID Compliance**

| Component | SRP | OCP | LSP | ISP | DIP |
|-----------|-----|-----|-----|-----|-----|
| Web StatCard | Renders stat content & trend display only | Trend/size/muted via CVA variants; new styles via props | Accepts any string/number values; trend optional without breaking | Props interface scoped to rendering concerns | Depends on `cn`, `Card`, and icons via props imports |
| Mobile StatCard | Render stat/tap handling only | Colors/sizes driven by theme + size prop; extensible via props/styles | Works with any label/value; trend optional | Props limited to rendering + onPress | Pulls colors from hook; icon injected via prop; haptics abstraction |

- **Parallel Sub-Agent Strategy:** If enabled, dedicate subagent for writing tests (web + mobile) while another prepares implementation scaffolds; run code-review subagent after each task block. No concurrent edits to same file.

- **Test Strategy (TDD first):**
  - **Web:** render label/value, default trend hidden when absent, trend direction icon + color mapping (up=green, down=red, neutral=slate), size variant classes applied, muted style reduces contrast, click handler fires, role="button" when clickable, data-slot presence, keyboard accessibility.
  - **Mobile:** render label/value, trend icon/color per direction, neutral trend shows minus icon, size variant font/icon sizes, press handler invoked, haptic feedback on press, accessibilityRole="button" when onPress, style override merges correctly.

---

## Task 1: Web - Create failing tests

**Files:**
- Create: `klard-web/src/__tests__/components/ui/stat-card.test.tsx`

**Step 1: Write the failing test**

```tsx
/**
 * Tests for StatCard Component
 *
 * TDD: Write failing tests first, then implement to pass.
 * Tests verify: rendering, trend variants, icon support, size variants, muted tone, click handling, accessibility
 */

import { describe, it, expect, vi } from "vitest"
import { render, screen, fireEvent } from "@testing-library/react"
import { StatCard } from "@/components/ui/stat-card"

describe("StatCard", () => {
  describe("Rendering", () => {
    it("should render label and value", () => {
      render(<StatCard label="Total Savings" value="$1,234" />)

      expect(screen.getByText("Total Savings")).toBeInTheDocument()
      expect(screen.getByText("$1,234")).toBeInTheDocument()
    })

    it("should have data-slot attribute", () => {
      render(<StatCard label="Metrics" value={100} />)

      const card = screen.getByText("Metrics").closest('[data-slot="stat-card"]')
      expect(card).toBeInTheDocument()
    })

    it("should render numeric value", () => {
      render(<StatCard label="Count" value={42} />)

      expect(screen.getByText("42")).toBeInTheDocument()
    })
  })

  describe("Trend Indicator", () => {
    it("should render up trend with green color", () => {
      render(
        <StatCard
          label="Growth"
          value="$500"
          trend={{ direction: "up", value: "+12%" }}
        />
      )

      const trendElement = screen.getByText("+12%")
      expect(trendElement).toBeInTheDocument()
      expect(trendElement.closest('[data-trend]')).toHaveAttribute('data-trend', 'up')
    })

    it("should render down trend with red color", () => {
      render(
        <StatCard
          label="Decline"
          value="$200"
          trend={{ direction: "down", value: "-8%" }}
        />
      )

      const trendElement = screen.getByText("-8%")
      expect(trendElement).toBeInTheDocument()
      expect(trendElement.closest('[data-trend]')).toHaveAttribute('data-trend', 'down')
    })

    it("should render neutral trend with slate color", () => {
      render(
        <StatCard
          label="Stable"
          value="$100"
          trend={{ direction: "neutral", value: "0%" }}
        />
      )

      const trendElement = screen.getByText("0%")
      expect(trendElement).toBeInTheDocument()
      expect(trendElement.closest('[data-trend]')).toHaveAttribute('data-trend', 'neutral')
    })

    it("should not render trend when not provided", () => {
      render(<StatCard label="No Trend" value="$50" />)

      expect(screen.queryByTestId("trend-indicator")).not.toBeInTheDocument()
    })
  })

  describe("Icon Support", () => {
    it("should render icon when provided", () => {
      const icon = <span data-testid="test-icon">ðŸ’°</span>
      render(<StatCard label="Savings" value="$100" icon={icon} />)

      expect(screen.getByTestId("test-icon")).toBeInTheDocument()
    })

    it("should not render icon container when icon not provided", () => {
      render(<StatCard label="No Icon" value="$100" />)

      expect(screen.queryByTestId("stat-card-icon")).not.toBeInTheDocument()
    })
  })

  describe("Size Variants", () => {
    it("should apply sm size classes", () => {
      render(<StatCard label="Small" value="100" size="sm" />)

      const card = screen.getByText("Small").closest('[data-slot="stat-card"]')
      expect(card?.className).toMatch(/py-3|px-4|text-sm/)
    })

    it("should apply md size classes (default)", () => {
      render(<StatCard label="Medium" value="100" />)

      const card = screen.getByText("Medium").closest('[data-slot="stat-card"]')
      expect(card).toBeTruthy()
    })

    it("should apply lg size classes", () => {
      render(<StatCard label="Large" value="100" size="lg" />)

      const card = screen.getByText("Large").closest('[data-slot="stat-card"]')
      expect(card?.className).toMatch(/py-5|px-5|text-lg/)
    })
  })

  describe("Muted Tone", () => {
    it("should apply muted styling when muted prop is true", () => {
      render(<StatCard label="Muted Stat" value="100" muted />)

      const card = screen.getByText("Muted Stat").closest('[data-slot="stat-card"]')
      expect(card?.className).toMatch(/opacity|text-muted/)
    })
  })

  describe("Click Handling", () => {
    it("should call onClick when clicked", () => {
      const handleClick = vi.fn()
      render(<StatCard label="Clickable" value="$100" onClick={handleClick} />)

      fireEvent.click(screen.getByText("Clickable").closest('[data-slot="stat-card"]')!)

      expect(handleClick).toHaveBeenCalledTimes(1)
    })

    it("should render as button when onClick provided", () => {
      const handleClick = vi.fn()
      render(<StatCard label="Button" value="100" onClick={handleClick} />)

      const card = screen.getByText("Button").closest('[data-slot="stat-card"]')
      expect(card?.tagName).toBe("BUTTON")
    })

    it("should render as div when onClick not provided", () => {
      render(<StatCard label="Static" value="100" />)

      const card = screen.getByText("Static").closest('[data-slot="stat-card"]')
      expect(card?.tagName).toBe("DIV")
    })

    it("should have interactive styles when clickable", () => {
      const handleClick = vi.fn()
      render(<StatCard label="Interactive" value="100" onClick={handleClick} />)

      const card = screen.getByText("Interactive").closest('[data-slot="stat-card"]')
      expect(card?.className).toMatch(/cursor-pointer|hover/)
    })
  })

  describe("Accessibility", () => {
    it("should have accessible role for clickable card", () => {
      const handleClick = vi.fn()
      render(<StatCard label="Accessible" value="100" onClick={handleClick} />)

      expect(screen.getByRole("button")).toBeInTheDocument()
    })
  })

  describe("Custom className", () => {
    it("should merge custom className", () => {
      render(<StatCard label="Custom" value="100" className="custom-class" />)

      const card = screen.getByText("Custom").closest('[data-slot="stat-card"]')
      expect(card?.className).toContain("custom-class")
    })
  })
})
```

**Step 2: Run test to verify it fails**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/stat-card.test.tsx --run
```

Expected: FAIL with "Cannot find module '@/components/ui/stat-card'"

---

## Task 2: Web - Implement StatCard component

**Files:**
- Create: `klard-web/src/components/ui/stat-card.tsx`
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Write implementation**

Create `klard-web/src/components/ui/stat-card.tsx` with CVA variants, data-slots, shadcn Card patterns, lucide icons, click handling, size/muted classes.

```tsx
"use client"

import * as React from "react"
import { TrendingUp, TrendingDown, Minus } from "lucide-react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const statCardVariants = cva(
  "bg-card text-card-foreground flex items-center justify-between gap-4 rounded-xl border shadow-sm transition-all",
  {
    variants: {
      size: {
        sm: "p-3 text-sm",
        md: "p-4 text-base",
        lg: "p-5 text-lg",
      },
      muted: {
        true: "opacity-75 border-muted",
        false: "",
      },
      clickable: {
        true: "cursor-pointer hover:border-teal-500 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2",
        false: "",
      },
    },
    defaultVariants: {
      size: "md",
      muted: false,
      clickable: false,
    },
  }
)

export interface StatCardProps extends React.HTMLAttributes<HTMLElement>, VariantProps<typeof statCardVariants> {
  /** Label describing the metric */
  label: string
  /** The metric value to display */
  value: string | number
  /** Optional trend indicator */
  trend?: {
    direction: "up" | "down" | "neutral"
    value: string
  }
  /** Optional icon to display */
  icon?: React.ReactNode
  /** Click handler - makes card interactive */
  onClick?: () => void
}

const trendConfig = {
  up: {
    icon: TrendingUp,
    className: "text-green-600 dark:text-green-400",
  },
  down: {
    icon: TrendingDown,
    className: "text-red-600 dark:text-red-400",
  },
  neutral: {
    icon: Minus,
    className: "text-slate-500 dark:text-slate-400",
  },
} as const

function StatCard({
  label,
  value,
  trend,
  icon,
  onClick,
  size,
  muted,
  className,
  ...props
}: StatCardProps) {
  const isClickable = !!onClick
  const Component = isClickable ? "button" : "div"

  return (
    <Component
      data-slot="stat-card"
      onClick={onClick}
      className={cn(
        statCardVariants({ size, muted, clickable: isClickable }),
        className
      )}
      {...props}
    >
      <div className="flex flex-col gap-1">
        <span className="text-sm text-muted-foreground">{label}</span>
        <span className={cn(
          "font-semibold tracking-tight",
          size === "sm" && "text-base",
          size === "md" && "text-2xl",
          size === "lg" && "text-3xl"
        )}>{value}</span>
        {trend && (
          <div
            data-trend={trend.direction}
            data-testid="trend-indicator"
            className={cn(
              "flex items-center gap-1 text-sm",
              trendConfig[trend.direction].className
            )}
          >
            {React.createElement(trendConfig[trend.direction].icon, {
              className: cn(
                size === "sm" && "h-3 w-3",
                size === "md" && "h-4 w-4",
                size === "lg" && "h-5 w-5"
              ),
              "aria-hidden": true,
            })}
            <span>{trend.value}</span>
          </div>
        )}
      </div>
      {icon && (
        <div
          data-testid="stat-card-icon"
          className={cn(
            "flex shrink-0 items-center justify-center rounded-full bg-teal-100 text-teal-700 dark:bg-teal-900/50 dark:text-teal-300",
            size === "sm" && "h-10 w-10",
            size === "md" && "h-12 w-12",
            size === "lg" && "h-14 w-14"
          )}
        >
          {icon}
        </div>
      )}
    </Component>
  )
}

export { StatCard, statCardVariants }
```

**Step 2: Add export to index.ts**

Add to `klard-web/src/components/ui/index.ts`:

```typescript
export { StatCard, type StatCardProps } from './stat-card';
```

**Step 3: Run tests to verify they pass**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/stat-card.test.tsx --run
```

Expected: PASS

**Step 4: Run TypeScript check**

```bash
pnpm --filter klard-web exec tsc --noEmit
```

Expected: No errors

**Step 5: Commit**

```bash
git add klard-web/src/components/ui/stat-card.tsx klard-web/src/components/ui/index.ts klard-web/src/__tests__/components/ui/stat-card.test.tsx
git commit -m "feat(web): add StatCard component for metric display"
```

---

## Task 3: Mobile - Create failing tests

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/StatCard.test.tsx`

**Step 1: Write the failing test**

```tsx
/**
 * Tests for StatCard Component (Mobile)
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react-native';
import { Text } from 'react-native';
import { StatCard } from '@/components/ui/StatCard';
import * as Haptics from 'expo-haptics';

// Mock expo-haptics
jest.mock('expo-haptics', () => ({
  impactAsync: jest.fn(),
  ImpactFeedbackStyle: {
    Light: 'light',
    Medium: 'medium',
    Heavy: 'heavy',
  },
}));

// Mock vector icons
jest.mock('@expo/vector-icons', () => {
  const React = require('react');
  const { Text } = require('react-native');
  return {
    Ionicons: ({ name }: { name: string }) => (
      <Text testID="vector-icon">{name}</Text>
    ),
  };
});

describe('StatCard', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  describe('Rendering', () => {
    it('should render label and value', () => {
      render(<StatCard label="Total Savings" value="$1,234" />);

      expect(screen.getByText('Total Savings')).toBeTruthy();
      expect(screen.getByText('$1,234')).toBeTruthy();
    });

    it('should render numeric value', () => {
      render(<StatCard label="Count" value={42} />);

      expect(screen.getByText('42')).toBeTruthy();
    });

    it('should have correct accessibility role', () => {
      render(<StatCard label="Metrics" value={100} testID="stat-card" />);

      expect(screen.getByTestId('stat-card')).toBeTruthy();
    });
  });

  describe('Trend Indicator', () => {
    it('should render up trend', () => {
      render(
        <StatCard
          label="Growth"
          value="$500"
          trend={{ direction: 'up', value: '+12%' }}
        />
      );

      expect(screen.getByText('+12%')).toBeTruthy();
      expect(screen.getByTestId('vector-icon')).toBeTruthy();
    });

    it('should render down trend', () => {
      render(
        <StatCard
          label="Decline"
          value="$200"
          trend={{ direction: 'down', value: '-8%' }}
        />
      );

      expect(screen.getByText('-8%')).toBeTruthy();
    });

    it('should render neutral trend', () => {
      render(
        <StatCard
          label="Stable"
          value="$100"
          trend={{ direction: 'neutral', value: '0%' }}
        />
      );

      expect(screen.getByText('0%')).toBeTruthy();
    });

    it('should not render trend when not provided', () => {
      render(<StatCard label="No Trend" value="$50" />);

      expect(screen.queryByTestId('trend-container')).toBeNull();
    });
  });

  describe('Icon Support', () => {
    it('should render icon when provided', () => {
      const icon = <Text testID="custom-icon">ðŸ’°</Text>;
      render(<StatCard label="Savings" value="$100" icon={icon} />);

      expect(screen.getByTestId('custom-icon')).toBeTruthy();
    });

    it('should not render icon container when icon not provided', () => {
      render(<StatCard label="No Icon" value="$100" testID="card" />);

      expect(screen.queryByTestId('icon-container')).toBeNull();
    });
  });

  describe('Size Variants', () => {
    it('should apply sm size styles', () => {
      render(<StatCard label="Small" value="100" size="sm" testID="card" />);

      const card = screen.getByTestId('card');
      expect(card).toBeTruthy();
    });

    it('should apply md size styles (default)', () => {
      render(<StatCard label="Medium" value="100" testID="card" />);

      const card = screen.getByTestId('card');
      expect(card).toBeTruthy();
    });

    it('should apply lg size styles', () => {
      render(<StatCard label="Large" value="100" size="lg" testID="card" />);

      const card = screen.getByTestId('card');
      expect(card).toBeTruthy();
    });
  });

  describe('Muted Tone', () => {
    it('should apply muted styling when muted prop is true', () => {
      render(<StatCard label="Muted" value="100" muted testID="card" />);

      const card = screen.getByTestId('card');
      expect(card).toBeTruthy();
    });
  });

  describe('Click Handling', () => {
    it('should call onClick when pressed', async () => {
      const handleClick = jest.fn();
      render(
        <StatCard
          label="Clickable"
          value="$100"
          onClick={handleClick}
          testID="stat-card"
        />
      );

      fireEvent.press(screen.getByTestId('stat-card'));

      await waitFor(() => {
        expect(handleClick).toHaveBeenCalledTimes(1);
      });
    });

    it('should trigger haptic feedback when pressed', async () => {
      const handleClick = jest.fn();
      render(
        <StatCard
          label="Haptic"
          value="$100"
          onClick={handleClick}
          testID="stat-card"
        />
      );

      fireEvent.press(screen.getByTestId('stat-card'));

      await waitFor(() => {
        expect(Haptics.impactAsync).toHaveBeenCalledWith(
          Haptics.ImpactFeedbackStyle.Light
        );
      });
    });

    it('should not trigger haptic when not clickable', () => {
      render(<StatCard label="Static" value="$100" testID="stat-card" />);

      // Static card should not respond to press
      expect(screen.getByTestId('stat-card')).toBeTruthy();
    });
  });
});
```

**Step 2: Run test to verify it fails**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/StatCard.test.tsx --run
```

Expected: FAIL with "Cannot find module '@/components/ui/StatCard'"

---

## Task 4: Mobile - Implement StatCard component

**Files:**
- Create: `klard-mobile/src/components/ui/StatCard.tsx`
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Write implementation**

Implement `klard-mobile/src/components/ui/StatCard.tsx` using `Pressable` when onClick exists, Ionicons for trend, size styles via StyleSheet, haptic feedback on press.

```tsx
import React from 'react';
import {
  View,
  Text,
  Pressable,
  StyleSheet,
  type ViewStyle,
  type StyleProp,
} from 'react-native';
import { Ionicons } from '@expo/vector-icons';
import * as Haptics from 'expo-haptics';

export interface StatCardProps {
  /** Label describing the metric */
  label: string;
  /** The metric value to display */
  value: string | number;
  /** Optional trend indicator */
  trend?: {
    direction: 'up' | 'down' | 'neutral';
    value: string;
  };
  /** Optional icon to display */
  icon?: React.ReactNode;
  /** Click handler - makes card interactive */
  onClick?: () => void;
  /** Size variant */
  size?: 'sm' | 'md' | 'lg';
  /** Muted tone for non-primary stats */
  muted?: boolean;
  /** Custom styles */
  style?: StyleProp<ViewStyle>;
  /** Test ID for testing */
  testID?: string;
}

const trendConfig = {
  up: {
    iconName: 'trending-up' as const,
    color: '#059669', // green-600 (light) / #10B981 (dark - handled via theme)
  },
  down: {
    iconName: 'trending-down' as const,
    color: '#DC2626', // red-600 (light) / #EF4444 (dark - handled via theme)
  },
  neutral: {
    iconName: 'remove' as const,
    color: '#64748B', // slate-500 (light) / #CBD5E1 (dark - handled via theme)
  },
} as const;

const sizeConfig = {
  sm: { padding: 12, fontSize: 14, valueFontSize: 18, iconSize: 16 },
  md: { padding: 16, fontSize: 16, valueFontSize: 24, iconSize: 18 },
  lg: { padding: 20, fontSize: 18, valueFontSize: 28, iconSize: 20 },
};

export function StatCard({
  label,
  value,
  trend,
  icon,
  onClick,
  size = 'md',
  muted = false,
  style,
  testID,
}: StatCardProps) {
  const isClickable = !!onClick;
  const sizeStyles = sizeConfig[size];

  const handlePress = async () => {
    if (onClick) {
      await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
      onClick();
    }
  };

  const Container = isClickable ? Pressable : View;
  const containerProps = isClickable
    ? {
        onPress: handlePress,
        style: ({ pressed }: { pressed: boolean }) => [
          styles.container,
          { padding: sizeStyles.padding },
          pressed && styles.pressed,
          muted && styles.muted,
          style,
        ],
      }
    : {
        style: [
          styles.container,
          { padding: sizeStyles.padding },
          muted && styles.muted,
          style,
        ],
      };

  return (
    <Container testID={testID} accessibilityRole={isClickable ? 'button' : undefined} {...containerProps}>
      <View style={styles.content}>
        <Text style={[styles.label, { fontSize: sizeStyles.fontSize }, muted && styles.mutedText]}>
          {label}
        </Text>
        <Text style={[styles.value, { fontSize: sizeStyles.valueFontSize }, muted && styles.mutedText]}>
          {value}
        </Text>
        {trend && (
          <View style={styles.trendContainer} testID="trend-container">
            <Ionicons
              name={trendConfig[trend.direction].iconName}
              size={sizeStyles.iconSize}
              color={trendConfig[trend.direction].color}
            />
            <Text
              style={[
                styles.trendValue,
                { fontSize: sizeStyles.fontSize },
                { color: trendConfig[trend.direction].color },
              ]}
            >
              {trend.value}
            </Text>
          </View>
        )}
      </View>
      {icon && (
        <View style={[styles.iconContainer, {
          width: sizeStyles.iconSize * 3,
          height: sizeStyles.iconSize * 3,
          borderRadius: sizeStyles.iconSize * 1.5,
        }]} testID="icon-container">
          {icon}
        </View>
      )}
    </Container>
  );
}

const styles = StyleSheet.create({
  container: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    gap: 16,
    backgroundColor: '#FFFFFF', // Light mode
    borderRadius: 12,
    borderWidth: 1,
    borderColor: 'rgba(15,23,42,0.08)',
    shadowColor: '#0F172A',
    shadowOffset: { width: 0, height: 1 },
    shadowOpacity: 0.05,
    shadowRadius: 2,
    elevation: 1,
  },
  pressed: {
    borderColor: '#0D7C7A', // primary accent
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 2,
  },
  muted: {
    opacity: 0.75,
    borderColor: '#E2E8F0',
  },
  content: {
    flex: 1,
    gap: 4,
  },
  label: {
    color: '#475569', // muted text (light)
    fontWeight: '400',
  },
  value: {
    color: '#0F172A', // foreground (light)
    fontWeight: '600',
    letterSpacing: -0.5,
  },
  mutedText: {
    opacity: 0.7,
  },
  trendContainer: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    marginTop: 4,
  },
  trendValue: {
    fontWeight: '500',
  },
  iconContainer: {
    backgroundColor: '#CCFBF1', // teal-100 (light)
    alignItems: 'center',
    justifyContent: 'center',
  },
});
```

**Step 2: Add export to index.ts**

Add to `klard-mobile/src/components/ui/index.ts`:

```typescript
export { StatCard, type StatCardProps } from './StatCard';
```

**Step 3: Run tests to verify they pass**

```bash
pnpm --filter klard-mobile test src/__tests__/components/ui/StatCard.test.tsx --run
```

Expected: PASS

**Step 4: Run TypeScript check**

```bash
pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No errors

**Step 5: Commit**

```bash
git add klard-mobile/src/components/ui/StatCard.tsx klard-mobile/src/components/ui/index.ts klard-mobile/src/__tests__/components/ui/StatCard.test.tsx
git commit -m "feat(mobile): add StatCard component for metric display"
```

---

## Task 5: Final verification and spec update

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md`

**Step 1: Run all tests**

```bash
pnpm --filter klard-web test src/__tests__/components/ui/stat-card.test.tsx --run
pnpm --filter klard-mobile test src/__tests__/components/ui/StatCard.test.tsx --run
```

Expected: All PASS

**Step 2: Run TypeScript checks**

```bash
pnpm --filter klard-web exec tsc --noEmit
pnpm --filter klard-mobile exec tsc --noEmit
```

Expected: No errors

**Step 3: Update spec marker to DONE**

Replace `<!-- IN-PROGRESS:5.7-stat-card -->` with `<!-- DONE:5.7-stat-card -->` in:
`docs/screens/batch/Klard_Component_Specifications.md`

**Step 4: Final commit**

```bash
git add docs/screens/batch/Klard_Component_Specifications.md
git commit -m "docs: mark StatCard component as DONE"
```

**Step 5: Final verification**

Ensure exports present, components render without runtime errors, accessibility checks satisfied, colors align with design tokens; if using subagents, run klard-ui-verify screenshots as follow-up.

---

## Verification Checklist

Before marking complete:

- [ ] Web component renders without errors
- [ ] Mobile component renders without errors
- [ ] All props implemented + typed (label, value, trend, icon, onClick, size, muted)
- [ ] All visual states functional (default, clickable/pressed, trends, sizes, muted)
- [ ] Trend indicators show correct colors (green up, red down, slate neutral)
- [ ] Size variants apply correct padding/text/icon sizes (sm/md/lg)
- [ ] Muted tone reduces contrast appropriately
- [ ] Accessibility attributes included (role="button" when clickable, data-slots)
- [ ] TypeScript passes with no errors
- [ ] All tests passing for both web and mobile
- [ ] Haptic feedback on mobile press
- [ ] Exported from components/ui/index.ts on both platforms
- [ ] Spec marker updated to DONE
- [ ] Color tokens match Klard design system

---

## Summary

| Task | Platform | Type | Files |
|------|----------|------|-------|
| 1 | Web | Test | stat-card.test.tsx |
| 2 | Web | Implementation | stat-card.tsx, index.ts |
| 3 | Mobile | Test | StatCard.test.tsx |
| 4 | Mobile | Implementation | StatCard.tsx, index.ts |
| 5 | Both | Verification | Klard_Component_Specifications.md |

**Total tasks:** 5 bite-sized tasks following TDD (RED â†’ GREEN â†’ REFACTOR)