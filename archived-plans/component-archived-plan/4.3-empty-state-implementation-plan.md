# 4.3 EmptyState Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a reusable EmptyState component for displaying friendly, actionable empty content states across both web and mobile platforms.

**Architecture:** Compound component pattern for web (EmptyState + EmptyStateMedia/Title/Description/Actions sub-components), single component with props for mobile. Both platforms support illustrations, title, description, and action buttons with consistent Klard design system styling.

**Tech Stack:**
- Web: React 19, TypeScript, Tailwind CSS 4, CVA for variants, Testing Library + Vitest
- Mobile: React Native, Expo SDK 54, expo-image, StyleSheet, Testing Library RN + Jest

---

## Component Specifications

- **Component:** EmptyState (web + mobile) for showing empty content placeholders with actions
- **Target Platforms:** Web (Next.js App Router) and Mobile (Expo)
- **Props (web):** Compound component using children composition
  - `size?: 'sm' | 'md' | 'lg'` (on root EmptyState component)
  - `className?: string`
  - Children: EmptyStateMedia, EmptyStateTitle, EmptyStateDescription, EmptyStateActions
- **Props (mobile):**
  - `title: string` (required)
  - `description?: string`
  - `illustration?: keyof typeof illustrations | string` (string key or custom source)
  - `illustrationAccessibilityLabel?: string`
  - `primaryAction?: { label: string; onPress: () => void }`
  - `secondaryAction?: { label: string; onPress: () => void }`
  - `testID?: string`
  - `style?: StyleProp<ViewStyle>`
- **Visual States:** default empty, with illustration, with primary action only, with both actions; disabled actions inherit from Button; layout supports responsive widths (web) and safe touch targets (mobile)
- **Size Variants:**
  - Web: `sm` (py-6 gap-3), `md` (py-12 gap-4, default), `lg` (py-16 gap-6)
  - Mobile: Fixed padding 24px, media size 160px
- **Color Tokens:**
  - Web: uses `bg-muted/40`, `border-dashed border-border`, text via foreground tokens; actions reuse Button variants (primary/ghost)
  - Mobile: uses Klard teal (#0D7C7A) and neutral text (#0F172A/#475569), actions reuse Button styling
- **Accessibility:**
  - Web: semantic heading (`h3`), description text, `aria-live="polite"` on container, data-slot attributes on root/media/header/content/actions; buttons inherit accessible labels, supports aria-label on root
  - Mobile: sets `accessibilityRole="summary"` on container, testIDs for image/root, uses Button `accessibilityRole="button"`, supports `illustrationAccessibilityLabel` for image
- **Dependencies:**
  - Web: `@/components/ui/button`, `@/lib/utils`, `class-variance-authority`
  - Mobile: `expo-image`, `@/components/ui/Button`, `StyleSheet`, theme constants

---

## SOLID Compliance

| Component | SRP | OCP | LSP | ISP | DIP |
|-----------|-----|-----|-----|-----|-----|
| EmptyState (Web) | Composes empty state UI | Extensible via children/slots | N/A | Single EmptyStateProps interface | Depends on Button abstraction |
| EmptyStateMedia | Renders illustration only | Supports ReactNode | N/A | Media-specific props | N/A |
| EmptyStateTitle | Renders title text | N/A | N/A | Title-specific props | N/A |
| EmptyStateDescription | Renders description | N/A | N/A | Description-specific props | N/A |
| EmptyStateActions | Container for buttons | N/A | N/A | Actions-specific props | N/A |
| EmptyState (Mobile) | Single empty state component | Extensible via props | N/A | EmptyStateProps interface | Depends on Button, Image abstractions |

### Principle Applications

**SRP (Single Responsibility Principle):** Each sub-component (web) handles ONE visual concern - media rendering, title display, description text, or action buttons. Mobile component handles layout composition but delegates rendering to Button/Image primitives.

**OCP (Open/Closed Principle):** Web extends via ReactNode children/slots without modification. Mobile extends via illustration key map and action props. Both closed for modification, open for extension.

**LSP (Liskov Substitution Principle):** N/A - no inheritance hierarchy used.

**ISP (Interface Segregation Principle):** Web separates props interfaces per sub-component (EmptyStateMedia, EmptyStateTitle, etc.). Mobile uses single focused EmptyStateProps interface with all optional except title.

**DIP (Dependency Inversion Principle):** Both platforms depend on Button abstraction (not concrete Button implementation). Mobile depends on expo-image abstraction (Image component), not direct image handling.

---

## Parallel Sub-Agent Strategy

Independent tasks that can run in parallel:
- Task 1 (Web tests) + Task 4 (Mobile tests) - No file conflicts
- Task 2 (Web impl) + Task 5 (Mobile impl) - Different packages
- Task 3 (Web exports) + Task 6 (Mobile exports) - Different index files

Sequential dependencies:
- Tests must complete before implementation (TDD)
- Implementation must complete before exports
- All must complete before TypeScript check

---

## Test Strategy (TDD)

### Web Tests (8 categories)
1. **Rendering:** with all sub-components, data-slot attributes, without optional components
2. **EmptyStateMedia:** children rendering, data-slot
3. **EmptyStateTitle:** text rendering, h3 element, data-slot
4. **EmptyStateDescription:** text rendering, data-slot
5. **EmptyStateActions:** primary button, multiple buttons, click handlers, data-slot
6. **Sizes:** sm/md/lg variants with correct padding classes
7. **Custom className:** merging with default classes
8. **Accessibility:** heading hierarchy, aria-label support

### Mobile Tests (6 categories)
1. **Rendering:** title only, title + description, testID support
2. **Illustration:** rendering via expo-image, absence when not provided
3. **Actions:** primary action rendering/pressing, secondary action rendering/pressing, both actions together
4. **Accessibility:** accessible title, illustrationAccessibilityLabel passthrough

---

## Task 1: Write Web EmptyState Tests

**Files:**
- Create: `klard-web/src/__tests__/components/ui/empty-state.test.tsx`

**Step 1: Write the failing tests**

```tsx
/**
 * Tests for EmptyState Component
 *
 * TDD: Write failing tests first, then implement to pass.
 * Tests verify: rendering, sub-components, actions, sizes, accessibility
 */

import { describe, it, expect, vi } from "vitest"
import { render, screen, fireEvent } from "@testing-library/react"
import {
  EmptyState,
  EmptyStateMedia,
  EmptyStateTitle,
  EmptyStateDescription,
  EmptyStateActions,
} from "@/components/ui/empty-state"
import { Button } from "@/components/ui/button"

describe("EmptyState", () => {
  describe("Rendering", () => {
    it("should render with all sub-components", () => {
      render(
        <EmptyState>
          <EmptyStateMedia>
            <span data-testid="illustration">ðŸŽ¨</span>
          </EmptyStateMedia>
          <EmptyStateTitle>No subscriptions yet</EmptyStateTitle>
          <EmptyStateDescription>
            Add your first subscription to start tracking.
          </EmptyStateDescription>
          <EmptyStateActions>
            <Button>Add Subscription</Button>
          </EmptyStateActions>
        </EmptyState>
      )

      expect(screen.getByTestId("illustration")).toBeInTheDocument()
      expect(screen.getByText("No subscriptions yet")).toBeInTheDocument()
      expect(
        screen.getByText("Add your first subscription to start tracking.")
      ).toBeInTheDocument()
      expect(
        screen.getByRole("button", { name: "Add Subscription" })
      ).toBeInTheDocument()
    })

    it("should have data-slot attribute on root", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
        </EmptyState>
      )

      expect(
        document.querySelector('[data-slot="empty-state"]')
      ).toBeInTheDocument()
    })

    it("should render without optional sub-components", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>No items</EmptyStateTitle>
        </EmptyState>
      )

      expect(screen.getByText("No items")).toBeInTheDocument()
    })
  })

  describe("EmptyStateMedia", () => {
    it("should render children as illustration", () => {
      render(
        <EmptyState>
          <EmptyStateMedia>
            <img src="/empty.svg" alt="Empty" data-testid="img" />
          </EmptyStateMedia>
          <EmptyStateTitle>Empty</EmptyStateTitle>
        </EmptyState>
      )

      expect(screen.getByTestId("img")).toBeInTheDocument()
    })

    it("should have data-slot attribute", () => {
      render(
        <EmptyState>
          <EmptyStateMedia>
            <span>Icon</span>
          </EmptyStateMedia>
          <EmptyStateTitle>Empty</EmptyStateTitle>
        </EmptyState>
      )

      expect(
        document.querySelector('[data-slot="empty-state-media"]')
      ).toBeInTheDocument()
    })
  })

  describe("EmptyStateTitle", () => {
    it("should render title text", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>No data found</EmptyStateTitle>
        </EmptyState>
      )

      expect(screen.getByText("No data found")).toBeInTheDocument()
    })

    it("should render as h3 element", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Title</EmptyStateTitle>
        </EmptyState>
      )

      expect(screen.getByRole("heading", { level: 3 })).toHaveTextContent(
        "Title"
      )
    })

    it("should have data-slot attribute", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Title</EmptyStateTitle>
        </EmptyState>
      )

      expect(
        document.querySelector('[data-slot="empty-state-title"]')
      ).toBeInTheDocument()
    })
  })

  describe("EmptyStateDescription", () => {
    it("should render description text", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
          <EmptyStateDescription>
            Start by adding your first item.
          </EmptyStateDescription>
        </EmptyState>
      )

      expect(
        screen.getByText("Start by adding your first item.")
      ).toBeInTheDocument()
    })

    it("should have data-slot attribute", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
          <EmptyStateDescription>Description</EmptyStateDescription>
        </EmptyState>
      )

      expect(
        document.querySelector('[data-slot="empty-state-description"]')
      ).toBeInTheDocument()
    })
  })

  describe("EmptyStateActions", () => {
    it("should render primary action button", () => {
      const handleClick = vi.fn()
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
          <EmptyStateActions>
            <Button onClick={handleClick}>Add Item</Button>
          </EmptyStateActions>
        </EmptyState>
      )

      const button = screen.getByRole("button", { name: "Add Item" })
      fireEvent.click(button)

      expect(handleClick).toHaveBeenCalledTimes(1)
    })

    it("should render multiple action buttons", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
          <EmptyStateActions>
            <Button>Primary Action</Button>
            <Button variant="ghost">Secondary Action</Button>
          </EmptyStateActions>
        </EmptyState>
      )

      expect(
        screen.getByRole("button", { name: "Primary Action" })
      ).toBeInTheDocument()
      expect(
        screen.getByRole("button", { name: "Secondary Action" })
      ).toBeInTheDocument()
    })

    it("should have data-slot attribute", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Empty</EmptyStateTitle>
          <EmptyStateActions>
            <Button>Action</Button>
          </EmptyStateActions>
        </EmptyState>
      )

      expect(
        document.querySelector('[data-slot="empty-state-actions"]')
      ).toBeInTheDocument()
    })
  })

  describe("Sizes", () => {
    it("should apply sm size", () => {
      render(
        <EmptyState size="sm">
          <EmptyStateTitle>Small</EmptyStateTitle>
        </EmptyState>
      )

      const container = document.querySelector('[data-slot="empty-state"]')
      expect(container?.className).toMatch(/py-6/)
      expect(container?.className).toMatch(/gap-3/)
    })

    it("should apply md size by default", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Medium</EmptyStateTitle>
        </EmptyState>
      )

      const container = document.querySelector('[data-slot="empty-state"]')
      expect(container?.className).toMatch(/py-12/)
      expect(container?.className).toMatch(/gap-4/)
    })

    it("should apply lg size", () => {
      render(
        <EmptyState size="lg">
          <EmptyStateTitle>Large</EmptyStateTitle>
        </EmptyState>
      )

      const container = document.querySelector('[data-slot="empty-state"]')
      expect(container?.className).toMatch(/py-16/)
      expect(container?.className).toMatch(/gap-6/)
    })
  })

  describe("Custom className", () => {
    it("should merge custom className with default classes", () => {
      render(
        <EmptyState className="custom-class">
          <EmptyStateTitle>Custom</EmptyStateTitle>
        </EmptyState>
      )

      const container = document.querySelector('[data-slot="empty-state"]')
      expect(container?.className).toContain("custom-class")
      expect(container?.className).toContain("flex") // Default class
    })
  })

  describe("Accessibility", () => {
    it("should have proper heading hierarchy", () => {
      render(
        <EmptyState>
          <EmptyStateTitle>Accessible Title</EmptyStateTitle>
          <EmptyStateDescription>Accessible description.</EmptyStateDescription>
        </EmptyState>
      )

      expect(
        screen.getByRole("heading", { name: "Accessible Title" })
      ).toBeInTheDocument()
    })

    it("should support aria-label on root", () => {
      render(
        <EmptyState aria-label="Empty subscriptions state">
          <EmptyStateTitle>No subscriptions</EmptyStateTitle>
        </EmptyState>
      )

      expect(
        screen.getByLabelText("Empty subscriptions state")
      ).toBeInTheDocument()
    })
  })
})
```

**Step 2: Run test to verify it fails**

Run: `pnpm --filter klard-web test src/__tests__/components/ui/empty-state.test.tsx --run`
Expected: FAIL with "Cannot find module '@/components/ui/empty-state'"

---

## Task 2: Implement Web EmptyState Component

**Files:**
- Create: `klard-web/src/components/ui/empty-state.tsx`

**Step 1: Tests should be failing from Task 1**

**Step 2: Write minimal implementation**

```tsx
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const emptyStateVariants = cva(
  "flex flex-col items-center justify-center text-center",
  {
    variants: {
      size: {
        sm: "py-6 gap-3",
        md: "py-12 gap-4",
        lg: "py-16 gap-6",
      },
    },
    defaultVariants: {
      size: "md",
    },
  }
)

export interface EmptyStateProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof emptyStateVariants> {}

function EmptyState({
  className,
  size,
  children,
  ...props
}: EmptyStateProps) {
  return (
    <div
      data-slot="empty-state"
      className={cn(emptyStateVariants({ size }), className)}
      aria-live="polite"
      {...props}
    >
      {children}
    </div>
  )
}

function EmptyStateMedia({
  className,
  children,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      data-slot="empty-state-media"
      className={cn("mb-2", className)}
      {...props}
    >
      {children}
    </div>
  )
}

function EmptyStateTitle({
  className,
  children,
  ...props
}: React.HTMLAttributes<HTMLHeadingElement>) {
  return (
    <h3
      data-slot="empty-state-title"
      className={cn(
        "text-lg font-semibold text-foreground",
        className
      )}
      {...props}
    >
      {children}
    </h3>
  )
}

function EmptyStateDescription({
  className,
  children,
  ...props
}: React.HTMLAttributes<HTMLParagraphElement>) {
  return (
    <p
      data-slot="empty-state-description"
      className={cn(
        "text-sm text-muted-foreground max-w-sm",
        className
      )}
      {...props}
    >
      {children}
    </p>
  )
}

function EmptyStateActions({
  className,
  children,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      data-slot="empty-state-actions"
      className={cn("flex gap-3 mt-2", className)}
      {...props}
    >
      {children}
    </div>
  )
}

export {
  EmptyState,
  EmptyStateMedia,
  EmptyStateTitle,
  EmptyStateDescription,
  EmptyStateActions,
}
```

**Step 3: Run test to verify it passes**

Run: `pnpm --filter klard-web test src/__tests__/components/ui/empty-state.test.tsx --run`
Expected: PASS

**Step 4: Commit**

```bash
git add klard-web/src/__tests__/components/ui/empty-state.test.tsx klard-web/src/components/ui/empty-state.tsx
git commit -m "feat(web): add EmptyState component with compound pattern"
```

---

## Task 3: Export Web EmptyState from Index

**Files:**
- Modify: `klard-web/src/components/ui/index.ts`

**Step 1: Add export to index**

Add the following export to the existing index.ts file:

```typescript
export {
  EmptyState,
  EmptyStateMedia,
  EmptyStateTitle,
  EmptyStateDescription,
  EmptyStateActions,
  type EmptyStateProps,
} from './empty-state';
```

**Step 2: Verify TypeScript compiles**

Run: `pnpm --filter klard-web exec tsc --noEmit`
Expected: No errors

**Step 3: Commit**

```bash
git add klard-web/src/components/ui/index.ts
git commit -m "feat(web): export EmptyState from ui index"
```

---

## Task 4: Write Mobile EmptyState Tests

**Files:**
- Create: `klard-mobile/src/__tests__/components/ui/EmptyState.test.tsx`

**Step 1: Write the failing tests**

```tsx
/**
 * Tests for EmptyState Component (Mobile)
 *
 * TDD: Write failing tests first, then implement to pass.
 */

import React from 'react';
import { render, screen, fireEvent } from '@testing-library/react-native';
import { EmptyState } from '@/components/ui/EmptyState';

// Mock expo-image
jest.mock('expo-image', () => {
  const React = require('react');
  const { View } = require('react-native');
  return {
    Image: ({ testID, accessibilityLabel }: { testID?: string; accessibilityLabel?: string }) => (
      <View testID={testID || 'expo-image'} accessibilityLabel={accessibilityLabel} />
    ),
  };
});

// Mock Button component
jest.mock('@/components/ui/Button', () => {
  const React = require('react');
  const { Pressable, Text } = require('react-native');
  return {
    Button: ({
      children,
      onPress,
      testID,
    }: {
      children: React.ReactNode;
      onPress?: () => void;
      testID?: string;
    }) => (
      <Pressable onPress={onPress} testID={testID} accessibilityRole="button">
        <Text>{children}</Text>
      </Pressable>
    ),
  };
});

describe('EmptyState', () => {
  describe('Rendering', () => {
    it('should render with title', () => {
      render(<EmptyState title="No subscriptions yet" />);

      expect(screen.getByText('No subscriptions yet')).toBeTruthy();
    });

    it('should render with title and description', () => {
      render(
        <EmptyState
          title="No subscriptions"
          description="Add your first subscription to start tracking."
        />
      );

      expect(screen.getByText('No subscriptions')).toBeTruthy();
      expect(
        screen.getByText('Add your first subscription to start tracking.')
      ).toBeTruthy();
    });

    it('should render with testID', () => {
      render(<EmptyState title="Empty" testID="empty-state" />);

      expect(screen.getByTestId('empty-state')).toBeTruthy();
    });
  });

  describe('Illustration', () => {
    it('should render illustration when provided', () => {
      render(
        <EmptyState
          title="No data"
          illustration="subscriptions"
        />
      );

      expect(screen.getByTestId('empty-state-illustration')).toBeTruthy();
    });

    it('should not render illustration container when not provided', () => {
      render(<EmptyState title="No data" />);

      expect(screen.queryByTestId('empty-state-illustration')).toBeNull();
    });
  });

  describe('Actions', () => {
    it('should render primary action when provided', () => {
      const handlePress = jest.fn();
      render(
        <EmptyState
          title="No items"
          primaryAction={{
            label: 'Add Item',
            onPress: handlePress,
          }}
        />
      );

      const button = screen.getByText('Add Item');
      expect(button).toBeTruthy();
    });

    it('should call onPress when primary action is pressed', () => {
      const handlePress = jest.fn();
      render(
        <EmptyState
          title="No items"
          primaryAction={{
            label: 'Add Item',
            onPress: handlePress,
          }}
        />
      );

      fireEvent.press(screen.getByText('Add Item'));

      expect(handlePress).toHaveBeenCalledTimes(1);
    });

    it('should render secondary action when provided', () => {
      render(
        <EmptyState
          title="No items"
          primaryAction={{
            label: 'Primary',
            onPress: () => {},
          }}
          secondaryAction={{
            label: 'Secondary',
            onPress: () => {},
          }}
        />
      );

      expect(screen.getByText('Primary')).toBeTruthy();
      expect(screen.getByText('Secondary')).toBeTruthy();
    });

    it('should call onPress when secondary action is pressed', () => {
      const handlePrimary = jest.fn();
      const handleSecondary = jest.fn();
      render(
        <EmptyState
          title="No items"
          primaryAction={{
            label: 'Primary',
            onPress: handlePrimary,
          }}
          secondaryAction={{
            label: 'Secondary',
            onPress: handleSecondary,
          }}
        />
      );

      fireEvent.press(screen.getByText('Secondary'));

      expect(handleSecondary).toHaveBeenCalledTimes(1);
      expect(handlePrimary).not.toHaveBeenCalled();
    });
  });

  describe('Accessibility', () => {
    it('should have accessible title', () => {
      render(<EmptyState title="No subscriptions" />);

      expect(screen.getByText('No subscriptions')).toBeTruthy();
    });

    it('should pass accessibilityLabel to illustration', () => {
      render(
        <EmptyState
          title="No data"
          illustration="subscriptions"
          illustrationAccessibilityLabel="Empty subscriptions illustration"
        />
      );

      expect(screen.getByLabelText('Empty subscriptions illustration')).toBeTruthy();
    });
  });
});
```

**Step 2: Run test to verify it fails**

Run: `pnpm --filter klard-mobile test src/__tests__/components/ui/EmptyState.test.tsx --run`
Expected: FAIL with "Cannot find module '@/components/ui/EmptyState'"

---

## Task 5: Implement Mobile EmptyState Component

**Files:**
- Create: `klard-mobile/src/components/ui/EmptyState.tsx`

**Step 1: Tests should be failing from Task 4**

**Step 2: Write minimal implementation**

```tsx
import React from 'react';
import { View, Text, StyleSheet, ViewStyle } from 'react-native';
import { Image } from 'expo-image';

import { Button } from './Button';
import { colors, spacing, typography } from '@/constants/theme';

// Illustration map - can be extended with actual illustration assets
const illustrations: Record<string, number | string> = {
  subscriptions: require('@/assets/images/empty-subscriptions.png'),
  cards: require('@/assets/images/empty-cards.png'),
  alerts: require('@/assets/images/empty-alerts.png'),
  // Add more as needed, fallback to placeholder
};

// Placeholder blurhash for smooth loading
const placeholderBlurhash = 'L6PZfSi_.AyE_3t7t7R**0o#DgR4';

export interface EmptyStateAction {
  label: string;
  onPress: () => void;
}

export interface EmptyStateProps {
  /** Main title text */
  title: string;
  /** Optional description text */
  description?: string;
  /** Illustration key or custom source */
  illustration?: keyof typeof illustrations | string;
  /** Accessibility label for illustration */
  illustrationAccessibilityLabel?: string;
  /** Primary action button */
  primaryAction?: EmptyStateAction;
  /** Secondary action button (ghost variant) */
  secondaryAction?: EmptyStateAction;
  /** Test ID for testing */
  testID?: string;
  /** Custom container style */
  style?: ViewStyle;
}

export function EmptyState({
  title,
  description,
  illustration,
  illustrationAccessibilityLabel,
  primaryAction,
  secondaryAction,
  testID,
  style,
}: EmptyStateProps) {
  const illustrationSource = illustration
    ? illustrations[illustration] || illustration
    : null;

  return (
    <View style={[styles.container, style]} testID={testID}>
      {illustrationSource && (
        <Image
          source={illustrationSource}
          style={styles.illustration}
          contentFit="contain"
          placeholder={{ blurhash: placeholderBlurhash }}
          transition={200}
          testID="empty-state-illustration"
          accessibilityLabel={illustrationAccessibilityLabel}
        />
      )}

      <Text style={styles.title}>{title}</Text>

      {description && (
        <Text style={styles.description}>{description}</Text>
      )}

      {(primaryAction || secondaryAction) && (
        <View style={styles.actions}>
          {primaryAction && (
            <Button onPress={primaryAction.onPress}>
              {primaryAction.label}
            </Button>
          )}
          {secondaryAction && (
            <Button variant="ghost" onPress={secondaryAction.onPress}>
              {secondaryAction.label}
            </Button>
          )}
        </View>
      )}
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
    paddingHorizontal: spacing.lg,
    paddingVertical: spacing.xl,
  },
  illustration: {
    width: 160,
    height: 160,
    marginBottom: spacing.lg,
  },
  title: {
    fontSize: typography.fontSize.lg,
    fontWeight: typography.fontWeight.semibold as '600',
    color: colors.foreground,
    textAlign: 'center',
    marginBottom: spacing.sm,
  },
  description: {
    fontSize: typography.fontSize.sm,
    color: colors.mutedForeground,
    textAlign: 'center',
    maxWidth: 280,
    marginBottom: spacing.md,
  },
  actions: {
    flexDirection: 'row',
    gap: spacing.md,
    marginTop: spacing.md,
  },
});
```

**Step 3: Run test to verify it passes**

Run: `pnpm --filter klard-mobile test src/__tests__/components/ui/EmptyState.test.tsx --run`
Expected: PASS

**Step 4: Commit**

```bash
git add klard-mobile/src/__tests__/components/ui/EmptyState.test.tsx klard-mobile/src/components/ui/EmptyState.tsx
git commit -m "feat(mobile): add EmptyState component with expo-image"
```

---

## Task 6: Export Mobile EmptyState from Index

**Files:**
- Modify: `klard-mobile/src/components/ui/index.ts`

**Step 1: Add export to index**

Add the following export to the existing index.ts file:

```typescript
export { EmptyState, type EmptyStateProps, type EmptyStateAction } from './EmptyState';
```

**Step 2: Verify TypeScript compiles**

Run: `pnpm --filter klard-mobile exec tsc --noEmit`
Expected: No errors

**Step 3: Commit**

```bash
git add klard-mobile/src/components/ui/index.ts
git commit -m "feat(mobile): export EmptyState from ui index"
```

---

## Task 7: Run Full TypeScript Check

**Files:** None (verification only)

**Step 1: Run TypeScript check for both packages**

Run: `pnpm --filter klard-web exec tsc --noEmit && pnpm --filter klard-mobile exec tsc --noEmit`
Expected: No errors

**Step 2: Run all tests**

Run: `pnpm --filter klard-web test --run && pnpm --filter klard-mobile test --run`
Expected: All tests pass

**Step 3: Optional visual verification (if env ready)**

Run: `pnpm --filter klard-web dev` then use klard-ui-verify skill to capture screenshots for EmptyState usage.
Expected: Screenshots align with design tokens (teal/navy, glassmorphism padding).

---

## Task 8: Update Spec to DONE

**Files:**
- Modify: `docs/screens/batch/Klard_Component_Specifications.md`

**Step 1: Update marker**

Replace:
```markdown
<!-- COMPONENT:START:4.3-empty-state -->
<!-- IN-PROGRESS:4.3-empty-state -->
```

With:
```markdown
<!-- COMPONENT:START:4.3-empty-state -->
<!-- DONE:4.3-empty-state -->
```

**Step 2: Commit all changes**

```bash
git add docs/screens/batch/Klard_Component_Specifications.md
git commit -m "docs: mark 4.3-empty-state component as done"
```

---

## Summary

| Task | Description | Platform | Dependencies |
|------|-------------|----------|--------------|
| 1 | Write Web tests | Web | None |
| 2 | Implement Web component | Web | Task 1 |
| 3 | Export Web component | Web | Task 2 |
| 4 | Write Mobile tests | Mobile | None |
| 5 | Implement Mobile component | Mobile | Task 4 |
| 6 | Export Mobile component | Mobile | Task 5 |
| 7 | TypeScript verification | Both | Tasks 3, 6 |
| 8 | Update spec to DONE | Docs | Task 7 |

**Parallel Execution Strategy:**
- Tasks 1 + 4 can run in parallel (independent tests)
- Tasks 2 + 5 can run in parallel (after their respective tests)
- Tasks 3 + 6 can run in parallel (after their respective implementations)
- Task 7 must wait for Tasks 3 and 6
- Task 8 must wait for Task 7